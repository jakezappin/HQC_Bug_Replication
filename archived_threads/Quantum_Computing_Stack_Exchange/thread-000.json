{"question": "\nI have two questions on UCCSD in qiskit, please see the code below.\nimport numpy as np\nfrom qiskit.chemistry.components.variational_forms import UCCSD\nfrom qiskit.chemistry.drivers import PySCFDriver, UnitsType\nfrom qiskit.chemistry import FermionicOperator\nfrom qiskit.aqua import QuantumInstance\ndef get_qubit_op( atom , basis , map_type ):\n    driver = PySCFDriver(atom=atom, unit=UnitsType.ANGSTROM, \n                         charge=0, spin=0, basis=basis)\n    molecule = driver.run()\n    repulsion_energy = molecule.nuclear_repulsion_energy\n    num_particles = molecule.num_alpha + molecule.num_beta\n    num_spin_orbitals = molecule.num_orbitals * 2\n    ferOp = FermionicOperator(h1=molecule.one_body_integrals, h2=molecule.two_body_integrals)\n    qubitOp = ferOp.mapping(map_type=map_type, threshold=0.00000001)\n#     qubitOp = Z2Symmetries.two_qubit_reduction(qubitOp, num_particles)\n    shift = repulsion_energy\n    return qubitOp, num_particles, num_spin_orbitals, shift\natom='H .0 .0 .0; H .0 .0 0.74'\nqubitOp, num_particles, num_spin_orbitals, shift = get_qubit_op( atom , basis = 'sto3g' , map_type = 'parity' )\nnum_qubits = qubitOp.num_qubits\nprint( 'num_qubits = ' , num_qubits ) \nfrom qiskit.chemistry.components.initial_states import HartreeFock    \ninit_state = HartreeFock( num_spin_orbitals , num_particles , 'parity' , two_qubit_reduction=False )\n# setup the variational form for VQE\nfrom qiskit.chemistry.components.variational_forms import UCCSD\nvar_form_vqe = UCCSD(\n        num_orbitals=num_spin_orbitals,\n        num_particles=num_particles,\n        initial_state=init_state,\n        qubit_mapping='parity' , \n        two_qubit_reduction = False\n    )\nprint( 'var_form_vqe.num_parameters = ' , var_form_vqe.num_parameters )\nvar_form_vqe.construct_circuit([1,1,1]).draw() # Give some random para\n\nThe outputs are (without the plot of the circuit)\nnum_qubits =  4\nvar_form_vqe.num_parameters =  3\n\nMy questions are\n1.\nWhy there are only 3 free parameters in UCCSD? Since I have 4 spin-orbs, I should expect there are at least 4^4 free parameters from the double excitation operators?\n2.\nIs there a way to see which operators are involved in UCCSD? I plot out the circuit, but there are \u201cEvolution^1\u201d block involved. If I use \u201cdecompose().\u201c, it shows all the 1 and 2 qubit operations? Would it be possible to show something in between, by which I mean for example adding barrier for the decomposed circuit, or showing which fermionic excitation operators are involved?\nMany thanks!\n", "answers": ["\nSince UCCSD is a particle- and spin-conserving variational form, the number of parameters does not only depend on the number of spin orbitals but also their \"nature\". What I mean by that is that you also need to consider these conservation rules which leads to the following scenario in your case:\nH2 has 2 electrons in 2 molecular orbitals, which correspond to 4 spin orbitals (and, thus, 4 qubits since you do not apply any reductions, here). Taking into account the spin-conservation you have the following possible single excitations:\n0 -> 1\n2 -> 3\n\nwhere I use Qiskit's notation in which spin orbitals are ordered block-wise (i.e. first all alpha orbitals, then all beta ones). If the spin was not conserved, then you would also see excitations such as 0 -> 3 and 1 -> 2.\nThe double excitations are a little bit simpler in this case because there is only one possibility regardless:\n0, 1 -> 2, 3\n\nHowever, if the example was more complex, the same reasoning would apply here, too.\nRegarding your second question: if you would like to see the excitation lists as I have written them above you can take a look at the single_excitations and double_excitations attributes of the UCCSD class.\nI am not aware of any \"partial\" decompose() functionality which could otherwise provide that you describe above.\n"], "comments": ["Thank you mrossinek. I will try what you suggested for the second point. Regarding your comment \"UCCSD is a particle- and spin-conserving variational form\", I am curious how we ensure a quantum circuit preserve particle numbers?", "Also you mentioned \"Qiskit's notation in which spin orbitals are ordered block-wise\", if you are familiar with how qiskit label the spin-orbitals, would you mind to help me on another question of mine? Many thanks!    quantumcomputing.stackexchange.com/questions/13803/\u2026", "After second thought, I think my confusion is due to the fact that I would like to use UCCSD with VQEAdapt. Since I can trigger the adaptive behavior of UCCSD with \u201cmanage_hopping_operators\u201d, and define my own pool of excitations from VQEAdapt. If there is an operator in the pool violate the particle number conservation, what will happen for the UCCSD?", "The particle-conservation is essentially hard-coded into the quantum circuit. I.e. we ensure that the number of 1s in the eigenstate remains constant (unless errors occur). I can take a look at the other question you linked later.", "As per your other comment regarding AdaptVQE: I honestly haven't tried a scenario where I add a non-particle conserving operator into the excitation pool. Although I originally added that code to Qiskit during the Qiskit Camp 2019 I barely ever used it at all.", "In the original VQEAdapt with \"excitation_pool=None\", indeed the particle number stay conserved throughout. But I tried a different excitation pool, and indeed the particle number could fluctuate to be like 2.0009. I am not sure if this is a numerical error or indeed the particle number is not conserved...."], "link": "https://quantumcomputing.stackexchange.com//questions/13933/on-number-of-parameters-and-operators-in-uccsd-in-qiskit?r=SearchResults"}