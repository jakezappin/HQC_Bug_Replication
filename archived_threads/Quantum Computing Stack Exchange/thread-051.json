{"question": "\nIs there a corresponding function that has the same function as function get_expectation_value() in Project Q?\n\nGet the expectation value of qubit_operator w.r.t. the current wave function representeenter preformatted text hered by the supplied quantum register.\nArgs:\n\nqubit_operator: Operator to measure.\nqureg: Quantum bits to measure.\n\nReturns: Expectation value\n\nfrom qiskit import QuantumCircuit, QuantumRegister, ClassicalRegister, Aer\nimport numpy as np\nfrom qiskit.aqua import QuantumInstance\nfrom qiskit.aqua.operators import PauliExpectation, CircuitSampler, StateFn, CircuitOp, CircuitStateFn\n\nqctl = QuantumRegister(10)\npsi = QuantumCircuit(qctl)\npsi.h(0)\npsi = CircuitStateFn(psi)\n\nqctl = QuantumRegister(10)\nop = QuantumCircuit(qctl)\nop.z(0)\nop.ry(np.pi/4,0)\nop = CircuitOp(op)\n\nbackend = Aer.get_backend('qasm_simulator')\nq_instance = QuantumInstance(backend, shots=1024)\nmeasurable_expression = StateFn(op, is_measurement=True).compose(psi)\nexpectation = PauliExpectation().convert(measurable_expression)\nsampler = CircuitSampler(q_instance).convert(expectation)\nprint('Expectation Value = ', sampler.eval())\n\n", "answers": [], "comments": ["Hi @nautilius! It is often a bad idea to try to translate verbatim from one framework to another as it often leads to strange code that does not follow the framework \"philosophy\". Could you provide an example (code) in Project-Q language of what you are trying to do? Or at least tell if you want to compute this using a quantum computer (so you need the quantum circuits) or if you just want the result and linear algebra is fine.", "Thank you for your answer\uff01I'm trying to get the value of <phi| operator |phi> in Qiskit with the corresponding Sample functions the same as in projectQ,  but there is a problem that when I use CircuitSampler to calculate the expectations, it's really slow, espacially when the target circuit include 5~10 qubits, it usually takes a few seconds to calculate. Is there any optimization tricks or other more direct way that I can use to accerlarate the process?", "Can you edit your question to add the problematic code (that is really slow)? Be sure to include everything that is needed in order for others to be able to replicate your results (a minimal working example if you are familiar with other SEs).", "ok, a small example is like above, although not all qubits of the register are used there, but my project will involve circuits of this scale"], "link": "https://quantumcomputing.stackexchange.com//questions/18280/qiskit-equivalent-of-get-expectation-value-in-projectq"}