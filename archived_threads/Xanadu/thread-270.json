{"0": {"author": "andre", "date": "1629665417322", "content": "Hello!\nTo test Strawberry Fields, I\u2019ve decided to compute the vibronic spectra of formic acid using GBS based on the electronic structure obtained from Firefly (or GAMESS). However, I would get two issues:\n\nCompared with the data provided in the strawberryfields.apps.data package, the number of modes are not the same;\nThe vibronic spectra are very different.\n\nMore explicitly, on my side, Firefly gives a total of 15 modes, so 9 vibronic modes, compared with 7 for data in strawberryfields.apps.data. As for the spectrum, I get the following:\n\nUnknown-61664\u00d71034 94.1 KB\n\nAs with my other post, I wish I could attach the data but I can\u2019t since I\u2019m a new user. Let me know how I should share the Firefly output files.\nThank you!\nAndre\n\n\n Solved by sjahangiri in post #9 \n\n\n                Hi @andre. \nThanks for the suggestion on documenting the process of using GAMESS data, we will consider that in the next refactor. \nThe fact that the DFT spectrum has a better agreement with the experimental one, compared to the one you obtained with HF, suggests that the shape of the spectrum is ve\u2026\n              \n", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/1"}, "1": {"author": "Alain_Delgado_Gran", "date": "1629747853719", "content": "Hello @andre,\nThank you for your question!\nRegarding your first point:\n\nCompared with the data provided in the  strawberryfields.apps.data  package, the number of modes are not the same\n\nThe data for formic acid provided in strawberryfields.apps.data was taken directly from this paper 3 by Joonsuk Huh et al. Please, see Sec. 2 of the supporting information.\nYou are right, formic acid has 9 vibrational modes. However, due to the symmetry of the molecule, the Duschinsky matrix for this vibronic transition is block diagonal with two blocks, one of dimension 7x7 (totally symmetric block) and the other with dimension 2x2 (non-totally symmetric block). If the overall shape of the spectrum is dominated by the totally symmetric block you can neglect the other two modes.\nSecond point:\n\n\nThe vibronic spectra are very different.\n\n\nThere may be several aspects related to this.\n1- The vibronic spectrum you want to simulate corresponds to the photoelectron emission of formic acid. So, you need to compute the vibrational modes of the ground states of the neutral and positively charged molecule in order to create the input data for the GBS simulations.\n2- Which type of electronic structure calculations are you performing to optimize the molecular geometries and compute the vibrational frequencies? Could you please provide us with the frequencies you have obtained? If they are different with respect to the ones reported in the above mentioned paper, the spectrum will be different.\n3- In principle, you don\u2019t need to account for the symmetry to obtain these values. I would expect that using the B3LYP functional with a Pople-type basis set e.g., 6-311++G** would be enough to reproduce the frequencies in the data set. GAMESS and Firefly should give you similar results.\n4- Assuming correctness of points 1-3, how many samples are you taking to reconstruct the vibronic spectrum?\nHope this helps.\nThank you!1 Reply", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/2"}, "2": {"author": "andre", "date": "1630004555432", "content": "Hi @Alain_Delgado_Gran,\nThank you very much for the detailed answer.\n\nYou are right, formic acid has 9 vibrational modes. However, due to the symmetry of the molecule, the Duschinsky matrix for this vibronic transition is block diagonal with two blocks, one of dimension 7x7 (totally symmetric block) and the other with dimension 2x2 (non-totally symmetric block). If the overall shape of the spectrum is dominated by the totally symmetric block you can neglect the other two modes.\n\nMakes sense. For the data I use, however, it doesn\u2019t look like there is a 7x7 totally symmetric block (data is included below). Would a non-symmetric Duschinsky matrix cause issues in the back-end?\n\n1- The vibronic spectrum you want to simulate corresponds to the photoelectron emission of formic acid. So, you need to compute the vibrational modes of the ground states of the neutral and positively charged molecule in order to create the input data for the GBS simulations.\n\nThat is what we do. However, we are relaxing the geometry of the excited state to avoid imaginary frequencies. Is this something you do too?\nAs for points 2-3, we do a Hartree-Fock-type calculation with the basis set being TZV or similar to 6-311+G**. However, we don\u2019t expect the spectrum to be radically different; peaks may shift but the overall shape should be similar.\n\n4- Assuming correctness of points 1-3, how many samples are you taking to reconstruct the vibronic spectrum?\n\nIn the spectrum shown in the last post, there are exactly 4675 samples. Referring to the vibronic spectra tutorial 2, it seems that with 10 samples you can already find the main peaks of the spectrum, pointing towards the fact that 4675 samples is more than enough to recover the overall shape.\nMoreover, using a conventional method, we were able to use the same data and compute a spectrum that is approximately correct, compared to experimental data.\nformic_acid778\u00d7560 60.1 KB\nThis may indicate that I\u2019m simply not using Strawberry Fields correctly. Thus, I\u2019m including the code used to run the simulation along with the data files.\nI\u2019d very much appreciate if you could help me fix this issue.\nThank you!\ntest.py (952 Bytes) formicAcidHF_Hess.txt (122.4 KB) formicAcidCationHF_Hess.txt (125.0 KB)1 Reply", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/3"}, "3": {"author": "Alain_Delgado_Gran", "date": "1630008976527", "content": "Hi @andre,\nThank you for your message and the attached files.\nJust to be clear. In order to compute the vibrational frequencies of the initial and final states you have to optimize the geometries of the neutral and the cation molecules. I noted that your electronic structure calculations were performed at the level of Hartree-Fock. That\u2019s why your frequencies are blueshifted w.r.t. the values used in the Vibronic spectra tutorial. 2 If you want to refine these numbers you can run density functional theory (DFT) simulations using the B3LYP functional. This way you would include electronic correlation effects and refine your frequencies. I assume that in Firefly you can do this by adding DFTTYP=b3lyp to the $CONTRL group in your input file.\nHaving said that, I would also expect that  this refinement should not change drastically the relative intensities of the vibronic spectrum.\nWe will take a look at the python script and get back to you soon!\nThank you.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/4"}, "4": {"author": "sjahangiri", "date": "1630083903704", "content": "Hi @andre. Please also note that the normal modes used to compute the Duschinsky with the duschinsky function need to be mass-weighted. I am not sure if Firefly prints out mass-weighted data but you can use:\nLi = Li[6:].T * m[:, np.newaxis]**0.5\nLf = Lf[6:].T * m[:, np.newaxis]**0.5\n\nand then call the duschinsky function. For more information please check the documentation here.\nI also highly recommend using DFT or a post-HF method with a basis set with proper size to get the input vibrational data. Please let us know if you face any issues.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/5"}, "5": {"author": "andre", "date": "1630173534703", "content": "Hi @sjahangiri,\nThanks for the tip for mass-weighting the normal modes, if made explicitly in the documentation I\u2019m sure it would help others. However, I still believe the resulting spectrum (shown below, with 1000 samples) is far from being in agreement with the experimental results (and with the results obtained using the conventional method as shown in my second post):\n\nUnknown-61452\u00d7859 75.5 KB\n\nIf you believe the discrepancies could be solved by simply using DFT, please let me know. Thanks again!", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/6"}, "6": {"author": "sjahangiri", "date": "1630332656212", "content": "Hi @andre. Please see a detailed explanation of the input format, including the normal modes format, for the duschinsky function here 4. I recommend using DFT, for example PBE0 or B3LYP functionals,  to compute the input data rather than HF. That, very likely, will give you the correct spectrum. Please let us know about the results. Thanks.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/7"}, "7": {"author": "andre", "date": "1630682485517", "content": "Hi @sjahangiri,\nConcerning the lack of proper documentation, I meant that it would be beneficial to have the process of using GAMESS data documented (i.e., skip over the first 5-6 modes and mass-weight the normal modes).\nAs for the vibronic spectrum calculation of formic acid, we\u2019ve tried with DFT (B3LYP) and although the spectrum does look better (spectrum and data attached below), I am not entirely satisfied and would like some pointers on how to obtain better results.\nAlso, if possible, could you please explain the procedure of removing the two independent modes to perform the computation with 7 modes (as described above by @Alain_Delgado_Gran)?\nThank you very much!\n\nUnknown-81452\u00d7859 66.2 KB\n\nformicAcidDFTHESS.TXT (190.4 KB) formicAcidCationDFTHESS.TXT (194.0 KB)", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/8"}, "8": {"author": "sjahangiri", "date": "1631024698786", "content": "Hi @andre.\nThanks for the suggestion on documenting the process of using GAMESS data, we will consider that in the next refactor.\nThe fact that the DFT spectrum has a better agreement with the experimental one, compared to the one you obtained with HF, suggests that the shape of the spectrum is very sensitive to the vibrational input data obtained from electronic structure calculations. So, my recommendation is to further improve the electronic structure calculations by using a functional that gives more accurate vibrational frequencies, using a better basis set or using post-HF ab initio methods.\nRegarding your last question, if you look at the vibrational modes of formic acid, you can see two groups of vibrations: one group of in-plane vibrations that contains 7 modes and a group of out-of-plane vibrations with two modes. In this paper 3, the authors have observed that the total vibronic spectrum is dominated by the modes of the first group and the second one can be safely neglected because of the lack of structural displacement. The vibrational frequencies for these two out-of-plane modes are 687.27, 1056.82 cm^-1, which are obtained from a DFT calculation using PBE0 functional. For more information, you can have a look at page 8 of the reference paper 3.Solution", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/9"}, "9": {"author": "andre", "date": "1631060263586", "content": "Thank you very much @sjahangiri and @Alain_Delgado_Gran, I\u2019ve marked the thread as solved.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/10"}, "10": {"author": "GSQ", "date": "1649512163238", "content": "Hello!\nI find it works well when I use GAMESS and qchem.read_gamess. However, when I use the result of ORCA there are some trouble. Do you know the difference between the output files of the two softwares.1 Reply", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/11"}, "11": {"author": "CatalinaAlbornoz", "date": "1649712398685", "content": "Hi @GSQ, welcome to the forum!\nCould you please share your code and the error or problem you\u2019re getting?\nYou can paste it here.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/12"}, "12": {"author": "sjahangiri", "date": "1649713962454", "content": "Hi @GSQ,\nIn addition to what @CatalinaAlbornoz mentioned, could you please also send us the raw vibrational frequencies you obtained with GAMESS and ORCA? I will take a close look as soon as I have the code and the data.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/13"}, "13": {"author": "GSQ", "date": "1649748871612", "content": "I planned to attach the codes and data at first, but I got  Sorry, new users can not upload attachments. I try to upload them somewhere else .\nhttps://rec.ustc.edu.cn/share/fb2ac8a0-ba39-11ec-adc5-e586ded18233 2\npassword:wysz\nThe raw vibrational frequencies of CH2O2 ground state from ORCA is\n$vibrational_frequencies\n15\n0        0.000000\n1        0.000000\n2        0.000000\n3        0.000000\n4        0.000000\n5        0.000000\n6      618.095481\n7      663.230409\n8     1033.405635\n9     1099.153775\n10     1275.317167\n11     1376.923912\n12     1780.978680\n13     2978.688601\n14     3646.386262\nI think it\u2019s good but the r I got is [ 0.74963814  0.48295573  0.29191516  0.19995845 -0.01301668 -0.38882838  -0.89582196 -1.68706532 -1.81765809]1 Reply", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/14"}, "14": {"author": "sjahangiri", "date": "1649788684009", "content": "Thanks @GSQ. The problem is very likely due to a format mismatch between the results extracted from GAMESS and ORCA. Could you please compare the data returned by read_gamess for atomic coordinates, atomic masses, normal mode frequencies and normal modes with those you extracted from  ORCA? You might copy the data here, so we can have a look as well. Thanks!", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/15"}, "15": {"author": "GSQ", "date": "1649789581698", "content": "The normal modes are just a part\nORCA\natomic coordinates\narray([ 1.01247043,  0.93593077,  1.64887887, -0.76188184, -0.15625193,\n0.1967257 , -0.45044505, -0.87018322, -1.92474336,  2.55700023,\n1.03050053,  0.66971448, -2.53818898, -0.29233976,  1.25398599])\natomic masses\narray([15.999, 15.999, 15.999, 12.011, 12.011, 12.011, 15.999, 15.999,\n15.999,  1.008,  1.008,  1.008,  1.008,  1.008,  1.008])\nnormal mode frequencies\narray([ 618.095481,  663.230409, 1033.405635, 1099.153775, 1275.317167,\n1376.923912, 1780.97868 , 2978.688601, 3646.386262])\nnormal modes\narray([[ 1.64270821e-02,  2.56421713e-02,  9.88458379e-03,\n-2.01771416e-01,  8.14087573e-02,  2.67346591e-02,\n-3.11053966e-03, -6.14263007e-04,  5.21353442e-02],\n[ 8.26718324e-02, -8.43765333e-02, -3.22910447e-02,\n-1.40453604e-01,  6.32196974e-03, -5.33726192e-03,\n1.98767488e-02,  3.09322513e-04,  3.84049704e-03],\n[ 2.02383672e-01,  3.26529198e-02,  1.24072657e-02,\n-2.07682377e-01, -4.81094308e-02, -3.52355761e-02,\n5.45858998e-02,  1.29824393e-03, -3.13564185e-02],\n[ 1.93972892e-01, -2.31462067e-02, -5.88059996e-02,\n2.30311237e-01, -2.06303454e-01,  2.63511527e-02,\n6.42201854e-02,  7.34463287e-02,  3.96697685e-03],\n[ 1.01125310e-02,  7.77109970e-02,  1.93460178e-01,\n9.34585910e-02, -7.65157464e-02,  1.06005903e-02,\n-2.06665848e-01,  4.66282722e-03,  7.46730494e-04],\nGAMESS\natomic coordinates\narray([ 0.53578,  0.49527,  0.87255, -0.40317, -0.08268,  0.1041 ,\n-0.23836, -0.46048, -1.01853,  1.35311,  0.54532,  0.3544 ,\n-1.34815, -0.1547 ,  0.66358])\natomic masses\narray([15.99491, 15.99491, 15.99491, 12.     , 12.     , 12.     ,\n15.99491, 15.99491, 15.99491,  1.00782,  1.00782,  1.00782,\n1.00782,  1.00782,  1.00782])\nnormal mode frequencies\narray([ 609.64324,  691.20728, 1026.82388, 1130.20324, 1292.5794 ,\n1375.11708, 1822.88544, 3000.72956, 3594.64996])\nnormal modes\narray([[ 2.11995871e-02,  9.06417789e-02, -2.98958036e-02,\n4.02115943e-01, -2.99801941e-01, -8.51944855e-02,\n-1.68709958e-02,  3.40449834e-03, -2.00595205e-01],\n[ 1.68721876e-01, -3.03408208e-01,  9.86100711e-02,\n2.98048780e-01, -5.78408775e-02,  3.09464764e-02,\n-3.88442199e-02, -6.73892783e-04, -1.34855744e-02],\n[ 4.29706713e-01,  1.13118403e-01, -3.76691268e-02,\n4.63605320e-01,  8.73708593e-02,  1.49055445e-01,\n-8.86674930e-02, -4.49164538e-03,  1.23927963e-01],\n[ 3.71839993e-01, -7.69091873e-02,  1.60193084e-01,\n-3.45513444e-01,  5.93445917e-01, -1.00158055e-01,\n-4.88233946e-02, -2.46219094e-01, -1.30349294e-02],\n[ 2.54594148e-02,  2.49505002e-01, -5.29221681e-01,\n-1.37340994e-01,  2.13133459e-01, -3.82807824e-02,\n2.61007170e-01, -1.52571852e-02, -1.94162896e-03],", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/16"}, "16": {"author": "sjahangiri", "date": "1649791765965", "content": "Hi @GSQ. The ORCA  atomic coordinates seem to be in Bohr while the GAMESS ones seem to be in \u00c5. You can convert the ORCA values to \u00c5 with the conversion factor given here.\nPlease let me know if this fixes the issue or if you have any problems with the conversion.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/17"}, "17": {"author": "GSQ", "date": "1649830426405", "content": "It seems not work.\nm=np.repeat(Ai[:,0],3)\nri=(Ai[:,1:4]).flatten()*0.529\nAf=ReadAtoms(ES)\nrf=(Af[:,1:4]).flatten()*0.529\nLi=ReadNM(GS)\nLi=Li[:,6:]\nLf=ReadNM(ES)\nLf=Lf[:,6:]\nwi=ReadFre(GS)\nwi=wi[6:]\nwf=ReadFre(ES)\nwf=wf[6:]\nThe r is array([ 0.74963814,  0.48295573,  0.29191516,  0.19995845, -0.01301668,        -0.38882838, -0.89582196, -1.68706532, -1.81765809])\nI notice that\n\nNORMAL MODES\nThese modes are the Cartesian displacements weighted by the diagonal matrix M(i,i)=1/sqrt(m[i]) where m[i] is the mass of the displaced atom. Thus, these vectors are normalized but not orthogonal\n\nDoes it matter?2 Replies", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/18"}, "18": {"author": "sjahangiri", "date": "1649853449726", "content": "Hi @GSQ. When I multiplies the atomic coordinates you provided with the conversion factor I get the following array which is different than the r  you copied in the last comment.\nr = np.array([ 1.01247043, 0.93593077, 1.64887887, -0.76188184, -0.15625193,\n0.1967257 , -0.45044505, -0.87018322, -1.92474336, 2.55700023,\n1.03050053, 0.66971448, -2.53818898, -0.29233976, 1.25398599])\n\nCould you please double check to make sure that the r values you are using is correct?\nIn terms of the normal modes, they need to be mass-weighted as explained here. Could you please also double check to see if you are using the mass-weighted normal modes?", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/19"}, "19": {"author": "GSQ", "date": "1649859000549", "content": "There should be only 9 values in  r. I can\u2019t get the r values like yours.  I think the normal modes are mass-weighted in the ORCA output file as I have mentioned.\n\n\n\n GSQ:\n\nNORMAL MODES\nThese modes are the Cartesian displacements weighted by the diagonal matrix M(i,i)=1/sqrt(m[i]) where m[i] is the mass of the displaced atom. Thus, these vectors are normalized but not orthogonal\n\n\nDo you use the data from\n\n\n\n GSQ:\n\nhttps://rec.ustc.edu.cn/share/fb2ac8a0-ba39-11ec-adc5-e586ded18233 \npassword:wysz\n\n2 Replies", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/20"}, "20": {"author": "sjahangiri", "date": "1649881387632", "content": "Hi @GSQ. Could you please upload your full code and the GAMESS input and output files to a publicly-accessible github page? I will run the code and will debug it.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/21"}, "21": {"author": "GSQ", "date": "1649916690840", "content": "\n\n\nGitHub\n\n\n\nGitHub - GongSiqiu/ORCA-vibronic-debug\nContribute to GongSiqiu/ORCA-vibronic-debug development by creating an account on GitHub.\n\n\n\n\n\n", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/22"}, "22": {"author": "sjahangiri", "date": "1649973728324", "content": "Thanks @GSQ. The problem is very likely due to a mismatch between the way that GAMESS and ORCA report the final results. I am working on your code and will let you know as soon as I find the problem with ORCA.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/23"}, "23": {"author": "sjahangiri", "date": "1650408933364", "content": "Hi @GSQ.\nI looked at the data extracted from GAMESS and ORCA and it seems that your code uses the normal modes of ORCA without mass weighting. You should double check the ORCA manual to see if the normal modes are already mass-weighted or not. You must also check the consistency of the units in which the normal mode displacements are printed.\nAlso, it seems that GAMESS and ORCA give somehow different vibrational frequencies and normal modes. You can visualize the vibrational normal modes and see if they are significantly different or not. In principle, with the same electronic structure method in your calculations, you must get almost identical vibrational frequencies and normal modes.\nYou can also compare the outputs of GAMESS and ORCA  for a smaller molecule such as hydrogen and see if you get identical results. It might help to resolve the inconsistency in the vibrational frequencies and normal modes.1", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/24"}, "24": {"author": "GSQ", "date": "1652890643873", "content": "I finally solved this  problem.   Noticed that\n\n\n\n GSQ:\n\nNORMAL MODES\nThese modes are the Cartesian displacements weighted by the diagonal matrix M(i,i)=1/sqrt(m[i]) where m[i] is the mass of the displaced atom. Thus, these vectors are normalized but not orthogonal\n\n\nwhen use the normal modes from ORCA, I need to mass-weight it to make it orthogonal and then normalize it. Finally it give me the correct result. Thank you very much!1", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/25"}, "25": {"author": "GSQ", "date": "1653028985192", "content": "Hello Alain,\nyou said\n\n\n\n Alain_Delgado_Gran:\n\nHowever, due to the symmetry of the molecule, the Duschinsky matrix for this vibronic transition is block diagonal with two blocks, one of dimension 7x7 (totally symmetric block) and the other with dimension 2x2 (non-totally symmetric block).\n\n\nHowever, the Duschinsky matrix I got is not block diagonal. \nDo I need to do some transformations on it?1 Reply", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/26"}, "26": {"author": "CatalinaAlbornoz", "date": "1653083633739", "content": "Hi @GSQ, thank you for your question. We will be taking a look at it and coming back with an answer hopefully on Tuesday. Have a good weekend!", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/27"}, "27": {"author": "sjahangiri", "date": "1653430671313", "content": "Hi @GSQ. This could be because of the electronic structure method you are using to compute the vibrational normal modes for formic acid, which very likely does not provide two sets of fully decoupled modes. If the shape of the spectrum matches the reference ones  given in this demo 1, no need to perform any transformations.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/28"}, "28": {"author": "GSQ", "date": "1653485463216", "content": "Thanks for your reply. I wonder how to get two sets of fully decoupled modes. Because it can reduce the time of calculation and the hardware demand efficiently.", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/29"}, "29": {"author": "sjahangiri", "date": "1653514314413", "content": "Hi @GSQ, the discussion on the Duschinsky matrix being block diagonal, was based on data taken from this paper. You might follow the procedure in the paper for performing the electronic structure calculations to obtain the vibrational frequencies and normal modes. It might require going beyond DFT though.1", "link": "https://discuss.pennylane.ai//t/issue-with-gbs-for-molecular-vibronic-spectra-formic-acid/1308/30"}}