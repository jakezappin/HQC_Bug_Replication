{"0": {"author": "Mahamiftikhar", "date": "1690973525643", "content": "Hello! i\u2019m working on a tutorial quantum nodes into kersa layer and using qnn layer for a modulation dataset. dataset contains 2D images of 11 different modulation types. these images contains 2 channels I and Q. i converted these images to a numpy file which has shape (2200, 100,100,2) where 2200 is the total no of images with size 100x100 and represent 2 channels. labels file shape is (2200,11). total classes are 11 and labels are categorical type. i want to apply this image dataset on qnn layer. i have tried but dont know how i modify this part of code shown below according to image dataset.\nimport pennylane as qml\nn_qubits = 2\ndev = qml.device(\u201cdefault.qubit\u201d, wires=n_qubits)\n@qml.qnode(dev)\ndef qnode(inputs, weights):\nqml.AngleEmbedding(inputs, wires=range(n_qubits))\nqml.BasicEntanglerLayers(weights, wires=range(n_qubits))\nreturn [qml.expval(qml.PauliZ(wires=i)) for i in range(n_qubits)]\nalso should i have to add flatten layer here\n\nclayer_1 = tf.keras.layers.Dense(2)\nclayer_2 = tf.keras.layers.Dense(2, activation=\u201csoftmax\u201d)\nmodel = tf.keras.models.Sequential([clayer_1, qlayer, clayer_2])\n", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/1"}, "1": {"author": "ludmilaaasb", "date": "1690991580644", "content": "Hello @Mahamiftikhar !\nI\u2019ll return to you soon. Would you mind sharing the output and/or error you getting from this script?", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/2"}, "2": {"author": "Mahamiftikhar", "date": "1690999019932", "content": "@ludmilaaasb  i got no error but i got very low validation accuracy approx equal to 0. i\u2019m sharing the code below\n\nimport pennylane as qml\n\nn_qubits = 14\ndev = qml.device(\u201cdefault.qubit\u201d, wires=n_qubits)\n@qml.qnode(dev, interface=\u2018tf\u2019, diff_method=\u2018backprop\u2019)\ndef qnode(inputs, weights):\nqml.AngleEmbedding(inputs, wires=range(n_qubits))\nqml.BasicEntanglerLayers(weights, wires=range(n_qubits))\nreturn [qml.expval(qml.PauliZ(wires=i)) for i in range(n_qubits)]\nn_layers = 17\nweight_shapes = {\u201cweights\u201d: (n_layers, n_qubits)}\nqlayer = qml.qnn.KerasLayer(qnode, weight_shapes, output_dim=n_qubits)\nflayer = tf.keras.layers.Flatten(input_shape=[100, 100, 2])\nclayer_1 = tf.keras.layers.Dense(2)\nclayer_2 = tf.keras.layers.Dense(11, activation=\u201csoftmax\u201d)\nmodel = tf.keras.models.Sequential([flayer, clayer_1, qlayer, clayer_2])\nmodel.compile(\noptimizer = \u2018adam\u2019,\nloss=\u201ccategorical_crossentropy\u201d,\nmetrics=[\u201caccuracy\u201d],\n)\n\nMahamiftikhar\n1M\noutput: running very slow\nEpoch 1/6\n330/330 - 9664s - loss: 2.3560 - accuracy: 0.1012 - val_loss: 2.7034 - val_accuracy: 0.0000e+00 - 9664s/epoch - 29s/step\ni dont know if i\u2019m using right no. of qubits and layers. kindly correct me it its wrong", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/3"}, "3": {"author": "ludmilaaasb", "date": "1691010232131", "content": "\ni got no error but i got very low validation accuracy approx equal to 0.\n\nYou have a quite big model, so probably it would take a lot of steps to train it. Have you considered increasing the number of steps?", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/4"}, "4": {"author": "Mahamiftikhar", "date": "1691017477214", "content": "it is very slow already as only 1 epochs take  9664s to execute. if i reduce the classical layers then also it is not showing accuracy above 20. can you please tell me, the no. of qubits i\u2019m using here which is 14, is this right, according to the shape of data. also suggest can i apply some another quantum machine learning approach to my modulation dataset for classification problem.", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/5"}, "5": {"author": "ludmilaaasb", "date": "1691029197992", "content": "Hello again!\n\nit is very slow already as only 1 epochs take 9664s to execute. if i reduce the classical layers then also it is not showing accuracy above 20.\n\nI\u2019m trying to follow up with your questions but I am not really sure what is the problem here. I\u2019m sorry, I guess I\u2019m not understanding you correctly. \nAnyway, if you think something is wrong, or you are getting some warning or error messages, send us a minimal, self-contained working version of your code. If you are not really sure how to do that, I would like to recommend this video. It will help you give us the exact amount of information so we can help you better! \n\ncan you please tell me, the no. of qubits i\u2019m using here which is 14, is this right, according to the shape of data.\n\nWell, this is a good question! I would say that it looks fine. But honestly, that\u2019s homework for you! Setting proper parameters to a model you would like to train is a whole research field in Machine Learning! I\u2019m afraid I can\u2019t help you with this one. \n\nalso suggest can i apply some another quantum machine learning approach to my modulation dataset for classification problem.\n\nSure thing! I\u2019ll suggest you take a look at this demo about convolutional networks. They are using the MNIST dataset! Maybe this could be a good starting point for your image classification problem. ", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/6"}, "6": {"author": "Mahamiftikhar", "date": "1691056189420", "content": "\nI\u2019m trying to follow up with your questions but I am not really sure what is the problem here. I\u2019m sorry, I guess I\u2019m not understanding you correctly. \n\nIt\u2019s ok  I\u2019m trying to say that i got no errors while executing the code but the issue is that end result i got was not satisfactory as the accuracy this model gave is very low. I was just asking that is anything we change in my model to increase the accuracy.\n\nSure thing! I\u2019ll suggest you take a look at this demo about convolutional networks. They are using the MNIST dataset! Maybe this could be a good starting point for your image classification problem. \n\nThanks for the suggestion. I will surely try this demo on my modulation dataset.1", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/7"}, "7": {"author": "Mahamiftikhar", "date": "1690973525643", "content": "Hello! i\u2019m working on a tutorial quantum nodes into kersa layer and using qnn layer for a modulation dataset. dataset contains 2D images of 11 different modulation types. these images contains 2 channels I and Q. i converted these images to a numpy file which has shape (2200, 100,100,2) where 2200 is the total no of images with size 100x100 and represent 2 channels. labels file shape is (2200,11). total classes are 11 and labels are categorical type. i want to apply this image dataset on qnn layer. i have tried but dont know how i modify this part of code shown below according to image dataset.\nimport pennylane as qml\nn_qubits = 2\ndev = qml.device(\u201cdefault.qubit\u201d, wires=n_qubits)\n@qml.qnode(dev)\ndef qnode(inputs, weights):\nqml.AngleEmbedding(inputs, wires=range(n_qubits))\nqml.BasicEntanglerLayers(weights, wires=range(n_qubits))\nreturn [qml.expval(qml.PauliZ(wires=i)) for i in range(n_qubits)]\nalso should i have to add flatten layer here\n\nclayer_1 = tf.keras.layers.Dense(2)\nclayer_2 = tf.keras.layers.Dense(2, activation=\u201csoftmax\u201d)\nmodel = tf.keras.models.Sequential([clayer_1, qlayer, clayer_2])\n", "link": "https://discuss.pennylane.ai//t/applying-quantum-layer-keras-for-modulation-images-dataset/3268/8"}}