{"0": {"author": "Yang", "date": "1666186531686", "content": "Hi, I notice that the latest PennyLane supports group measurement of Pauli word. However, when I try to measure two Hermitian matrixes |00><00| and |01><01|, it raised  TypeError. Currently,  is this type of group measurement not supported? Or is there something wrong with my code? Here is the code.\nimport pennylane as qml\nfrom pennylane import numpy as np\n\ndef get_projector_of_computation_basis(index, n_qubit):\n    \"\"\"generate projector of computational basis as observable\n\n    Args:\n        index (int): the index of computational basis |i>\n        n_qubit (int): the number of qubits\n\n    Returns:\n        _type_: _description_\n    \"\"\"\n    state_01 = {'0': np.array([1, 0]), '1':np.array([0, 1])}\n    state_basis = 1\n    index_bin = bin(index)[2:].rjust(n_qubit, '0')\n    for i in range(n_qubit):\n        state_basis = np.kron(state_basis, state_01[index_bin[n_qubit-i-1]])\n    return qml.Hermitian(np.outer(state_basis, state_basis), wires=[i for i in range(n_qubit)])\n\ndev = qml.device(\"default.qubit\", wires=2)\n\n@qml.qnode(dev)\ndef circuit(x, obs=None):\n    qml.RX(x, wires=0)\n    qml.Hadamard(wires=1)\n    qml.CNOT(wires=[0, 1])\n    return [qml.expval(ob) for ob in obs]\n\nobs = [get_projector_of_computation_basis(0, 2), get_projector_of_computation_basis(1, 2)]\n\nprint(circuit(0.5, obs))\n\nLooking forward to your advice.\nThanks.", "link": "https://discuss.pennylane.ai//t/simultaneously-measure-the-expectation-of-multiple-hermitian-matrixes/2227/1"}, "1": {"author": "isaacdevlugt", "date": "1666296568773", "content": "Hey @Yang!\nBTW, you don\u2019t have to go through so much to get projectors. PennyLane\u2019s got you covered \nhttps://docs.pennylane.ai/en/stable/code/api/pennylane.Projector.html 1\nThe reason your error is occurring is because some wires are being measured multiple times. PennyLane tries to come up with qubit-wise commuting groups for the two observables being measured, but hit an error because  qml.Hermitian  is being used. The grouping logic is only supported for Pauli observables, hence the error message!\nIt looks like you\u2019ll have to run your circuit serially. Here is an example using qml.Projector \ndev = qml.device(\"default.qubit\", wires=2)\n\n@qml.qnode(dev)\ndef circuit(state):\n    return qml.expval(qml.Projector(np.array(state), wires=dev.wires))\n\nstates = [[0,0], [1,1]]\n\nfor state in states:\n    print(circuit(state))\n", "link": "https://discuss.pennylane.ai//t/simultaneously-measure-the-expectation-of-multiple-hermitian-matrixes/2227/2"}, "2": {"author": "Yang", "date": "1666589607580", "content": "Hi @isaacdevlugt, thank you for the  advice. It is convenient that PennyLane provides qml.Projector. I will have a try.1", "link": "https://discuss.pennylane.ai//t/simultaneously-measure-the-expectation-of-multiple-hermitian-matrixes/2227/3"}, "3": {"author": "isaacdevlugt", "date": "1666623560445", "content": "Let us know if you have any other issues with your code!", "link": "https://discuss.pennylane.ai//t/simultaneously-measure-the-expectation-of-multiple-hermitian-matrixes/2227/4"}, "4": {"author": "Yang", "date": "1666186531686", "content": "Hi, I notice that the latest PennyLane supports group measurement of Pauli word. However, when I try to measure two Hermitian matrixes |00><00||00><00| and |01><01||01><01|, it raised  TypeError. Currently,  is this type of group measurement not supported? Or is there something wrong with my code? Here is the code.\nimport pennylane as qml\nfrom pennylane import numpy as np\n\ndef get_projector_of_computation_basis(index, n_qubit):\n    \"\"\"generate projector of computational basis as observable\n\n    Args:\n        index (int): the index of computational basis |i>\n        n_qubit (int): the number of qubits\n\n    Returns:\n        _type_: _description_\n    \"\"\"\n    state_01 = {'0': np.array([1, 0]), '1':np.array([0, 1])}\n    state_basis = 1\n    index_bin = bin(index)[2:].rjust(n_qubit, '0')\n    for i in range(n_qubit):\n        state_basis = np.kron(state_basis, state_01[index_bin[n_qubit-i-1]])\n    return qml.Hermitian(np.outer(state_basis, state_basis), wires=[i for i in range(n_qubit)])\n\ndev = qml.device(\"default.qubit\", wires=2)\n\n@qml.qnode(dev)\ndef circuit(x, obs=None):\n    qml.RX(x, wires=0)\n    qml.Hadamard(wires=1)\n    qml.CNOT(wires=[0, 1])\n    return [qml.expval(ob) for ob in obs]\n\nobs = [get_projector_of_computation_basis(0, 2), get_projector_of_computation_basis(1, 2)]\n\nprint(circuit(0.5, obs))\n\nLooking forward to your advice.\nThanks.", "link": "https://discuss.pennylane.ai//t/simultaneously-measure-the-expectation-of-multiple-hermitian-matrixes/2227/5"}}