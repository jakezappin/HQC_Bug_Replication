{"0": {"author": "mass_of_15", "date": "1690877071818", "content": "Hi, I am currently using NVIDIA DGX A100 GPU. When I am running the code using Lightning GPU, I am getting the error. The code I am running is:\nwires=4\ndev4 = qml.device('lightning.gpu', wires=wires )\n@qml.qnode(dev4)\ndef CONVCircuit(phi, wires, i=0):\n    \"\"\"\n    quantum convolution Node\n    \"\"\"\n    # parameter\n    theta = np.pi / 2\n    qml.Rot(phi[0]*2*np.pi/255,phi[1]*2*np.pi/255,phi[2]*2*np.pi/255, wires=0)\n    qml.Rot(phi[3]*2*np.pi/255,phi[4]*2*np.pi/255,phi[5]*2*np.pi/255, wires=1)\n    qml.Rot(phi[6]*2*np.pi/255,phi[7]*2*np.pi/255,phi[8]*2*np.pi/255, wires=2)\n    qml.Rot(phi[9]*2*np.pi/255,phi[10]*2*np.pi/255,phi[11]*2*np.pi/255, wires=3)\n\n    qml.RX(np.pi, wires=0)\n    qml.RX(np.pi, wires=1)\n    qml.RX(np.pi, wires=2)\n    qml.RX(np.pi, wires=3)\n\n    qml.CRZ(theta, wires=[1, 0])\n    qml.CRZ(theta, wires=[3, 2])\n    qml.CRX(theta, wires=[1, 0])\n    qml.CRX(theta, wires=[3, 2])\n    qml.CRZ(theta, wires=[2, 0])\n    qml.CRX(theta, wires=[2, 0])\n\n    # Expectation value\n    measurement = qml.expval(qml.PauliZ(wires=0))\n\n    return measurement\n\nThe full error message is below:\nPLException: [/project/pennylane_lightning_gpu/src/util/DataBuffer.hpp][Line:37][Method:DataBuffer]: Error in PennyLane Lightning: the provided PTX was compiled with an unsupported toolchain.\n\nThe output of qml.about() is:\nName: PennyLane\nVersion: 0.28.0\nSummary: PennyLane is a Python quantum machine learning library by Xanadu Inc.\nHome-page: https://github.com/XanaduAI/pennylane\nAuthor: \nAuthor-email: \nLicense: Apache License 2.0\nLocation: /dgxb_home/se21pphy004/miniconda3/envs/myenv/lib/python3.8/site-packages\nRequires: appdirs, autograd, autoray, cachetools, networkx, numpy, pennylane-lightning, requests, retworkx, scipy, semantic-version, toml\nRequired-by: PennyLane-Lightning, PennyLane-Lightning-GPU\n\nPlatform info:           Linux-5.4.0-144-generic-x86_64-with-glibc2.17\nPython version:          3.8.17\nNumpy version:           1.24.3\nScipy version:           1.10.1\nInstalled devices:\n- default.gaussian (PennyLane-0.28.0)\n- default.mixed (PennyLane-0.28.0)\n- default.qubit (PennyLane-0.28.0)\n- default.qubit.autograd (PennyLane-0.28.0)\n- default.qubit.jax (PennyLane-0.28.0)\n- default.qubit.tf (PennyLane-0.28.0)\n- default.qubit.torch (PennyLane-0.28.0)\n- default.qutrit (PennyLane-0.28.0)\n- null.qubit (PennyLane-0.28.0)\n- lightning.qubit (PennyLane-Lightning-0.28.0)\n- lightning.gpu (PennyLane-Lightning-GPU-0.28.0)\n\nThe nvcc version is:\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2021 NVIDIA Corporation\nBuilt on Mon_Sep_13_19:13:29_PDT_2021\nCuda compilation tools, release 11.5, V11.5.50\nBuild cuda_11.5.r11.5/compiler.30411180_0\n\nCan anyone tell me what I should add, remove or upgrade any packages?", "link": "https://discuss.pennylane.ai//t/pennylane-lightning-gpu-not-working/3256/1"}, "1": {"author": "Ivana_at_Xanadu", "date": "1690893255909", "content": "Hi @mass_of_15, I see you had a similar problem a few months ago.\nIs there any chance the instructions here or here already help you? \nIf not, let me know and we\u2019ll see what we can do \u2014 but it would be really helpful if you could share the (full) runnable Python file with us. That way we can check the details.", "link": "https://discuss.pennylane.ai//t/pennylane-lightning-gpu-not-working/3256/2"}, "2": {"author": "mass_of_15", "date": "1690911168839", "content": "Hi @Ivana_at_Xanadu, The instructions were helpful when I used DGX V100; now, I am using DGX A100 as the university has upgraded its DGX systems. Is it because of the compatibility issue between Pennylane and the DGX server?\nAlso, the code is the same as given here in my first post: Pennylane-Lightning GPU 1.", "link": "https://discuss.pennylane.ai//t/pennylane-lightning-gpu-not-working/3256/3"}, "3": {"author": "mlxd", "date": "1690912349115", "content": "HI @mass_of_15\nCan you request the CUDA toolchain to be updated to 11.7/11.8 on the system you are running \u2013 for the best support with the Ampere architecture, you may need a newer version of the toolchain.\nI\u2019d also suggest upgrading your version of PennyLane to the latest (0.31), and ensuring you are using the CUDA 11 version of cuQuantum (python -m pip install custatevec-cu11).2", "link": "https://discuss.pennylane.ai//t/pennylane-lightning-gpu-not-working/3256/4"}, "4": {"author": "mass_of_15", "date": "1690877071818", "content": "Hi, I am currently using NVIDIA DGX A100 GPU. When I am running the code using Lightning GPU, I am getting the error. The code I am running is:\nwires=4\ndev4 = qml.device('lightning.gpu', wires=wires )\n@qml.qnode(dev4)\ndef CONVCircuit(phi, wires, i=0):\n    \"\"\"\n    quantum convolution Node\n    \"\"\"\n    # parameter\n    theta = np.pi / 2\n    qml.Rot(phi[0]*2*np.pi/255,phi[1]*2*np.pi/255,phi[2]*2*np.pi/255, wires=0)\n    qml.Rot(phi[3]*2*np.pi/255,phi[4]*2*np.pi/255,phi[5]*2*np.pi/255, wires=1)\n    qml.Rot(phi[6]*2*np.pi/255,phi[7]*2*np.pi/255,phi[8]*2*np.pi/255, wires=2)\n    qml.Rot(phi[9]*2*np.pi/255,phi[10]*2*np.pi/255,phi[11]*2*np.pi/255, wires=3)\n\n    qml.RX(np.pi, wires=0)\n    qml.RX(np.pi, wires=1)\n    qml.RX(np.pi, wires=2)\n    qml.RX(np.pi, wires=3)\n\n    qml.CRZ(theta, wires=[1, 0])\n    qml.CRZ(theta, wires=[3, 2])\n    qml.CRX(theta, wires=[1, 0])\n    qml.CRX(theta, wires=[3, 2])\n    qml.CRZ(theta, wires=[2, 0])\n    qml.CRX(theta, wires=[2, 0])\n\n    # Expectation value\n    measurement = qml.expval(qml.PauliZ(wires=0))\n\n    return measurement\n\nThe full error message is below:\nPLException: [/project/pennylane_lightning_gpu/src/util/DataBuffer.hpp][Line:37][Method:DataBuffer]: Error in PennyLane Lightning: the provided PTX was compiled with an unsupported toolchain.\n\nThe output of qml.about() is:\nName: PennyLane\nVersion: 0.28.0\nSummary: PennyLane is a Python quantum machine learning library by Xanadu Inc.\nHome-page: https://github.com/XanaduAI/pennylane\nAuthor: \nAuthor-email: \nLicense: Apache License 2.0\nLocation: /dgxb_home/se21pphy004/miniconda3/envs/myenv/lib/python3.8/site-packages\nRequires: appdirs, autograd, autoray, cachetools, networkx, numpy, pennylane-lightning, requests, retworkx, scipy, semantic-version, toml\nRequired-by: PennyLane-Lightning, PennyLane-Lightning-GPU\n\nPlatform info:           Linux-5.4.0-144-generic-x86_64-with-glibc2.17\nPython version:          3.8.17\nNumpy version:           1.24.3\nScipy version:           1.10.1\nInstalled devices:\n- default.gaussian (PennyLane-0.28.0)\n- default.mixed (PennyLane-0.28.0)\n- default.qubit (PennyLane-0.28.0)\n- default.qubit.autograd (PennyLane-0.28.0)\n- default.qubit.jax (PennyLane-0.28.0)\n- default.qubit.tf (PennyLane-0.28.0)\n- default.qubit.torch (PennyLane-0.28.0)\n- default.qutrit (PennyLane-0.28.0)\n- null.qubit (PennyLane-0.28.0)\n- lightning.qubit (PennyLane-Lightning-0.28.0)\n- lightning.gpu (PennyLane-Lightning-GPU-0.28.0)\n\nThe nvcc version is:\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2021 NVIDIA Corporation\nBuilt on Mon_Sep_13_19:13:29_PDT_2021\nCuda compilation tools, release 11.5, V11.5.50\nBuild cuda_11.5.r11.5/compiler.30411180_0\n\nCan anyone tell me what I should add, remove or upgrade any packages?", "link": "https://discuss.pennylane.ai//t/pennylane-lightning-gpu-not-working/3256/5"}}