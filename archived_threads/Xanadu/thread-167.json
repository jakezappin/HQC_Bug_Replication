{"0": {"author": "angelinaG", "date": "1580313540250", "content": "Hi Andrea,\nCould you help me understand the following error when loading the pre-trained quantum weights? I have been trying to adapt the Quantum transfer learning code from your paper to my problem statement.\nAs explained by you, I trained my model_hybrid in pennylane simulator and saved the trained model as a .pt file. When I try to load the saved sate_dict  in order to execute the model on the actual quantum hardware  it gives me a \"keys mismatch\" error as follows:\n\nimage1115\u00d7390 84.2 KB\n\nP.S.: I am following your exact code for my work-- the ants vs. bees example executed perfectly on the IBMQ machine as stated in my previous reply to Quantum transfer learning code (Mari et al., 2019) - IBMQDevice endless execution. I have no issues with loading the quantum_weights.pt file there. That code executed perfectly well. My problem is with another image classification problem at hand. How did you save the pre-trained model? I used the following function to do so:\ntorch.save(model.state_dict(), PATH)\nAre there any specific parameters that you specified while saving the trained model?\n\n\n Solved by andreamari in post #2 \n\n\n                Hi @angelinaG, \nI think the problem is that you saved the parameters of full model (model_hybrid) and you are trying to load them on the last layer of the model (model_hybrid.fc).  You have two alternative options: \n\nreplace model_hybrid.fc.load_state_dict() with model_hybrid.load_state_dict(),\nkeep\u2026\n              \n1", "link": "https://discuss.pennylane.ai//t/loading-the-load-state-dict-from-quantum-weights-pt-file/327/1"}, "1": {"author": "andreamari", "date": "1580315888323", "content": "Hi @angelinaG,\nI think the problem is that you saved the parameters of full model (model_hybrid) and you are trying to load them on the last layer of the model (model_hybrid.fc).  You have two alternative options:\n\nreplace model_hybrid.fc.load_state_dict() with model_hybrid.load_state_dict(),\nkeep  model_hybrid.fc.load_state_dict() as it is, but repeat the training phase and save  model_hybrid.fc.state_dict() instead of   model_hybrid.state_dict()\n\n\nThis should solve your problem, Andrea1 ReplySolution2", "link": "https://discuss.pennylane.ai//t/loading-the-load-state-dict-from-quantum-weights-pt-file/327/2"}, "2": {"author": "angelinaG", "date": "1580342458593", "content": "Thank you very much @andreamari for your prompt response. I highly appreciate it.\nI shall try this out.", "link": "https://discuss.pennylane.ai//t/loading-the-load-state-dict-from-quantum-weights-pt-file/327/3"}, "3": {"author": "angelinaG", "date": "1580368490494", "content": "Hi @andreamari!\nThank you once again!\nI tried option 2 and it worked ", "link": "https://discuss.pennylane.ai//t/loading-the-load-state-dict-from-quantum-weights-pt-file/327/4"}, "4": {"author": "angelinaG", "date": "1580313540250", "content": "Hi Andrea,\nCould you help me understand the following error when loading the pre-trained quantum weights? I have been trying to adapt the Quantum transfer learning code from your paper to my problem statement.\nAs explained by you, I trained my model_hybrid in pennylane simulator and saved the trained model as a .pt file. When I try to load the saved sate_dict  in order to execute the model on the actual quantum hardware  it gives me a \"keys mismatch\" error as follows:\n\nimage1115\u00d7390 84.2 KB\n\nP.S.: I am following your exact code for my work-- the ants vs. bees example executed perfectly on the IBMQ machine as stated in my previous reply to Quantum transfer learning code (Mari et al., 2019) - IBMQDevice endless execution. I have no issues with loading the quantum_weights.pt file there. That code executed perfectly well. My problem is with another image classification problem at hand. How did you save the pre-trained model? I used the following function to do so:\ntorch.save(model.state_dict(), PATH)\nAre there any specific parameters that you specified while saving the trained model?\n\n\n Solved by andreamari in post #2 \n\n\n                Hi @angelinaG, \nI think the problem is that you saved the parameters of full model (model_hybrid) and you are trying to load them on the last layer of the model (model_hybrid.fc).  You have two alternative options: \n\nreplace model_hybrid.fc.load_state_dict() with model_hybrid.load_state_dict(),\nkeep\u2026\n              \n1", "link": "https://discuss.pennylane.ai//t/loading-the-load-state-dict-from-quantum-weights-pt-file/327/5"}}