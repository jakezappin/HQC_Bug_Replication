{"0": {"author": "RX1", "date": "1694976846546", "content": "I am having trouble reading the optimiser documentation. I am trying to understand what the individual outputs of the step_and_cost and step functions are, however the documentation is not as easy to understand as I would like it to be. So here please ask what are the individual outputs of the step_and_cost and step functions and what data types. Also is it possible to read the gradient of each step, I failed to read the gradient of pennylane.", "link": "https://discuss.pennylane.ai//t/cant-understand-what-the-multiple-outputs-of-the-step-and-cost-and-step-functions-are/3440/1"}, "1": {"author": "isaacdevlugt", "date": "1695053893298", "content": "Hey @RX1! Thanks for the feedback \nLet\u2019s look at an example. I\u2019ve taken some of this code from our qubit rotation demo 1. I\u2019ll define the usual things first (a differentiable function that relies on the output of a quantum circuit):\nimport pennylane as qml\nfrom pennylane import numpy as np\n\ndev1 = qml.device(\"lightning.qubit\", wires=1)\n\n@qml.qnode(dev1)\ndef circuit(params):\n    qml.RX(params[0], wires=0)\n    qml.RY(params[1], wires=0)\n    return qml.expval(qml.PauliZ(0))\n\ndef cost(x):\n    return circuit(x)\n\ninit_params = np.array([0.011, 0.012], requires_grad=True)\nprint(cost(init_params))\n\n0.9998675058299389\n\nAccording to the documentation, opt.step will just give you the parameters back as an output:\nparams = init_params\n\nopt = qml.GradientDescentOptimizer(stepsize=0.4)\n\nfor _ in range(3):\n    params = opt.step(cost, params)\n    print(params)\n\n[0.01539959 0.01679959]\n[0.02155832 0.02351832]\n[0.03017859 0.03292259]\n\nopt.step_and_cost behaves somewhat similarly to opt.step, but outputs the cost function\u2019s value before the parameters were updated.\nparams = init_params\n\nopt = qml.GradientDescentOptimizer(stepsize=0.4)\n\nfor _ in range(3):\n    params, cost_val = opt.step_and_cost(cost, params)\n    print(params, cost_val)\n\n[0.01539959 0.01679959] 0.9998675058299389\n[0.02155832 0.02351832] 0.9997403354524409\n[0.03017859 0.03292259] 0.9994911497625389\n\nIf you had multiple individual parameters in your circuit like the example below, then your output would correspond as follows\n@qml.qnode(dev1)\ndef circuit(param1, param2):\n    qml.RX(param1, wires=0)\n    qml.RY(param2, wires=0)\n    return qml.expval(qml.PauliZ(0))\n\ndef cost(x1, x2):\n    return circuit(x1, x2)\n\ninit_x1, init_x2 = np.array([0.011], requires_grad=True), np.array([0.012], requires_grad=True)\nprint(cost(init_x1, init_x2))\n\n0.9998675058299389\n\nx1, x2 = init_x1, init_x2\n\nopt = qml.GradientDescentOptimizer(stepsize=0.4)\n\nfor _ in range(3):\n    x1, x2 = opt.step(cost, x1, x2)\n    print(x1, x2)\n\n[0.01539959] [0.01679959]\n[0.02155832] [0.02351832]\n[0.03017859] [0.03292259]\n\nand with opt.step_and_cost, you just need to make sure that your parameters are inside of a tuple \u2014 the output of step_and_cost is still two things: your parameters and the cost function\u2019s value before the parameters were updated.\nx1, x2 = init_x1, init_x2\n\nopt = qml.GradientDescentOptimizer(stepsize=0.4)\n\nfor _ in range(3):\n    (x1, x2), cost_val = opt.step_and_cost(cost, x1, x2)\n    print(x1, x2, cost_val)\n\n[0.01539959] [0.01679959] 0.9998675058299389\n[0.02155832] [0.02351832] 0.9997403354524409\n[0.03017859] [0.03292259] 0.9994911497625389\n\n\nAlso is it possible to read the gradient of each step, I failed to read the gradient of pennylane.\n\nIt sure is! I encourage you to check out this section of the qubit rotation demo 1.\nHope this helps!2", "link": "https://discuss.pennylane.ai//t/cant-understand-what-the-multiple-outputs-of-the-step-and-cost-and-step-functions-are/3440/2"}, "2": {"author": "RX1", "date": "1694976846546", "content": "I am having trouble reading the optimiser documentation. I am trying to understand what the individual outputs of the step_and_cost and step functions are, however the documentation is not as easy to understand as I would like it to be. So here please ask what are the individual outputs of the step_and_cost and step functions and what data types. Also is it possible to read the gradient of each step, I failed to read the gradient of pennylane.", "link": "https://discuss.pennylane.ai//t/cant-understand-what-the-multiple-outputs-of-the-step-and-cost-and-step-functions-are/3440/3"}}