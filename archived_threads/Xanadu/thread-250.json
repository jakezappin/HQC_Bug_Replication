{"0": {"author": "Raghav_Ramki", "date": "1674603638774", "content": "Hello!\nI\u2019ve been using Pennylane to develop hybrid Tensorflow models. Everything works great when I run it locally, but I run into issues when I try and set my device to the \u2018ibmq_qasm_simulator\u2019.\nOn IBM Quantum Dashboard, I can see jobs coming in and being completed, and my software runs perfectly. However, I was wondering if there was away I could approximate the number of jobs / amount of time my code will take to be run on their simulator.\nSomething like a ETA for completing the model.fit would be nice.\nThanks, and feel free to ask me any questions!", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/1"}, "1": {"author": "Raghav_Ramki", "date": "1674605006180", "content": "@qml.qnode(dev)\ndef qnode(inputs, weights):\n    qml.AngleEmbedding(inputs, wires=range(n_qubits))\n    qml.BasicEntanglerLayers(weights, wires=range(n_qubits))\n    return [qml.expval(qml.PauliZ(wires=i)) for i in range(n_qubits)]\n\nis my qnode, run locally w/ lightning.qubits, wires=2\nn_layers = 1\nweight_shapes = {\"weights\": (n_layers, n_qubits)}\nqnode2 = qml.QNode(qnode, dev)\nqlayer = qml.qnn.KerasLayer(qnode2, weight_shapes, output_dim=n_qubits, dtype='float64')\n\nclayer_1 = tf.keras.layers.Dense(50, input_shape=(43,), activation='relu')\nclayer_3 = tf.keras.layers.Dense(2 ,activation='relu')\nclayer_4 = tf.keras.layers.Dense(1)\nmodel = tf.keras.models.Sequential([clayer_1, clayer_3, qlayer, clayer_4])\n\nIt\u2019s not an ideal network for my use case, but I\u2019m trying to familiarize myself with the tools before I start going deeper into building better / more advanced networks.\nTakes abt 20min/epoch locally, w/ batch_size = 128. Is there anyway I can use this to figure out how many jobs it will take to run on IBM Qasm Simulator backend?\nI\u2019m still in high school, so apologies if I have misunderstood any of the techniques.", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/2"}, "2": {"author": "Raghav_Ramki", "date": "1674663179947", "content": "After trying to run the code over night, after 40k shots I ran out of available jobs to use on the ibmq simulator. Is there anyway I can set the number of shots/jobs to prevent it from going over my limit?", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/3"}, "3": {"author": "CatalinaAlbornoz", "date": "1674778130214", "content": "Hi @Raghav_Ramki, welcome to the Forum!\nI\u2019m sorry that you ran out of shots. You may be able to contact someone at IBM through the Qiskit Slack to see if they can give you some extra shots.\nIt seems that the problem that you\u2019re trying to run is very big. You can in fact set the number of shots when you define your device. You can use something like the following code:\nb = \"ibmq_qasm_simulator\"\n\ndev = qml.device(\n    \"qiskit.ibmq\",\n    wires=2,\n    backend=b,\n    shots = 1\n)\n\nNotice that this will use one shot every time you run your circuit. Since you will run your circuit many times this will take many shots. The exact number of shots will depend on your exact dataset, how you encode the information in the circuit, etc.\nBatches are not working well with our PennyLane-Qiskit plugin at the moment. This is on our radar for fixing. If you want to learn more about this you can take a look at this forum post 2 about Torch Layer where someone reported the problem.\nSo if your dataset has about 200 datapoints then you will need about 200 circuit executions/epoch, and 200 shots/epoch if you have set shots=1 and if you\u2019re using one datapoint at a time.\nPlease let me know if this helps or if you have any additional questions.1 Reply", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/4"}, "4": {"author": "Raghav_Ramki", "date": "1674920927605", "content": "Awesome! This is working great for me.", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/5"}, "5": {"author": "Raghav_Ramki", "date": "1674951830878", "content": "Hello!\nI ran into a few more problems while trying this solution.\nI am using 1024 shots per execution, and I only have 36 units over which I am training.\nWhen run on a local simulator, I go from 1/36 to sample 36/36 in ~30 minutes.\nI assumed that when run on an actual piece of quantum hardware, it would take only 36 jobs, per your previous answer.\nInstead, my model is going well above that. Is this due to my large batch size? Or because it is part of a larger neural network, that I assumed was being trained locally?", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/6"}, "6": {"author": "CatalinaAlbornoz", "date": "1675203522439", "content": "Hi @Raghav_Ramki ,\nYes, unfortunately batching circuits on IBM hardware doesn\u2019t work well. If you have classical processing (eg. a classical neural network) this is done locally, unless you\u2019re using Qiskit Runtime.\nMy suggestion would be to reduce the size of your dataset and not use batches if you want to run on IBM hardware. Please let me know if this works for you!", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/7"}, "7": {"author": "Raghav_Ramki", "date": "1674603638774", "content": "Hello!\nI\u2019ve been using Pennylane to develop hybrid Tensorflow models. Everything works great when I run it locally, but I run into issues when I try and set my device to the \u2018ibmq_qasm_simulator\u2019.\nOn IBM Quantum Dashboard, I can see jobs coming in and being completed, and my software runs perfectly. However, I was wondering if there was away I could approximate the number of jobs / amount of time my code will take to be run on their simulator.\nSomething like a ETA for completing the model.fit would be nice.\nThanks, and feel free to ask me any questions!", "link": "https://discuss.pennylane.ai//t/pennylane-qiskit-number-of-jobs/2457/8"}}