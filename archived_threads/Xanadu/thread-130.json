{"0": {"author": "Dassen_Sathan", "date": "1680228758581", "content": "Hi,\nI\u2019ve tried the code for calculating ground energy for water molecule and it worked fine but when i\u2019m trying more complex molecule such as benzene c6h6, it get stuck on building the hamiltonian . i have tried changing the parameters such as  number of orbitals, basis set etc but no progress.", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/1"}, "1": {"author": "isaacdevlugt", "date": "1680528493586", "content": "Hey @Dassen_Sathan! It\u2019s probably that the Hamiltonian is so big that it just takes a while to generate the qubit representation of it. Indeed, if I try generating the qubit Hamiltonian of benzene on my laptop, it takes a while!\nDo you need to run this calculation on your laptop? It might be better if you have access to a remote server that you can run this on.", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/2"}, "2": {"author": "Dassen_Sathan", "date": "1680574459267", "content": "Thanks Isaac,  for the reply as i have docking molecules that is bigger than benzene. Can you please give me the steps to follow to build hamiltonian on a remote server.\nIs there a way to speed up the process on laptop?\ncheers", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/3"}, "3": {"author": "isaacdevlugt", "date": "1680637064470", "content": "You might actually be able to get away with generating the molecular Hamiltonian on your laptop with the pyscf backend 1:\nimport pennylane as qml\nfrom pennylane import qchem \n\nlabels, coords = qchem.mol_data(\"C6H6\")\nbenzene_hamiltonian = qchem.molecular_hamiltonian(labels, coords, method='pyscf')\n\nAs far as finding its ground state energy, though, you will definitely need to define an active space 2 \u2014 the qubit Hamiltonian is 72 qubits ! In that case, I\u2019d still recommend using the pyscf backend, but specify a reasonable number of active electrons:\nbenzene_hamiltonian = qchem.molecular_hamiltonian(labels, coords, method='pyscf', active_electrons=4)\n\nThat line above ran for me in under 2 minutes on my laptop . Hope this helps!2 Replies", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/4"}, "4": {"author": "isaacdevlugt", "date": "1681134534101", "content": "Hey @Dassen_Sathan,\nIt sounds like you\u2019re trying to simulate an unphysical electronic structure. The number of electrons and the corresponding spin you set aren\u2019t physically possible. Can you share your code?2 Replies", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/5"}, "5": {"author": "isaacdevlugt", "date": "1681309315470", "content": "The error here is stemming from this method 4. The number of alpha/beta electrons here means number of spin up/down electrons, and the error is saying that n_\\alpha + n_\\beta \\neq 63.\nLooking at your code, I can indeed replicate the error you\u2019re getting. But, there are a few things that I\u2019m confused about:\n\n\nbenzene_hamiltonian isn\u2019t used beyond grabbing the number of qubits, but later on you define a different variable H with more electronic structure details . Not sure which one you want to use, but I assume it\u2019s H because that\u2019s what your VQE is optimizing against.\n\n\nsymbols isn\u2019t defined, but I assume you meant labels.\n\n\nIf I get rid of benzene_hamiltonian and move the electronic structure variable definitions above H (e.g., charge, multiplicity, etc.) so that it can be defined, I get a new error: ValueError: Openshell systems are not supported. Change the charge or spin multiplicity of the molecule. This means that there are unpaired electrons, which, as the error suggests, isn\u2019t supported. I tried several multiplicity values, assuming that you want charge to remain 0, and none of them worked.\n\n\nIn any case, I\u2019m going to get in touch with one of our qchem experts to see if they can help here . Hang tight!", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/6"}, "6": {"author": "sjahangiri", "date": "1681324224819", "content": "Hi @Dassen_Sathan and thanks for using PennyLane!\nThe error you are getting is because of an inconsistency in the number of electrons and spin multiplicity. The molecule defined in the 3htbjz4_dock.txt file has 63 electrons (9 * 6 + 8 + 1, for C, O, and H, respectively) but your spin multiplicity is the default value of 1 which corresponds to a system with no spin-unpaird electron. To fix the error, please make sure that you construct your molecular Hamiltonian with the correct multiplicity of 2 to account for an odd number of electrons in your molecule:\nH, qubits = qchem.molecular_hamiltonian(\n    labels,\n    coords,\n    charge=0,\n    mult=2,\n    basis='sto-3g',\n    method='pyscf',\n    active_electrons=5,\n    active_orbitals=4,\n)\n\nPlease see here 5 for more details on multiplicity. Please also note that I have changed the number of  active_electrons from 4 to 5 to make sure that the core electrons are not unpaired.\nAlso, your molecule seems to be missing some hydrogen atoms as I think what you aim to simulate is 2-Propylphenol 3. If this is the case, please make sure that you are using the correct charge and multiplicity after adding the missing hydrogen atoms. Finlay, if you need to construct your Hamiltonian few times in the code, please make sure that you use the correct input parameters everywhere. Feel free to let us know if you have any other questions!", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/7"}, "7": {"author": "sjahangiri", "date": "1681392348678", "content": "Hi @Dassen_Sathan. You can use the mol_data 3 function to obtain the symbols and geometry of a compound from the PubChem database. For instance, the symbols and geometry of 2-Propylphenol can be obtained with\nqml.qchem.mol_data(\"2-Propylphenol\")\nPlease inspect the symbols and the geometry properly to make sure that the molecule is the correct one and let us know if you have any other questions.2 Replies", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/8"}, "8": {"author": "sjahangiri", "date": "1681759125442", "content": "Hi @Dassen_Sathan. The following code should work and give you the Hamiltonian in a few seconds, assuming that the desired molecule is 2-Propylphenol.\nimport pennylane as qml\nfrom pennylane import numpy as np\n\nlabels, coords = qml.qchem.mol_data(\"2-Propylphenol\")\n\nH, qubits = qml.qchem.molecular_hamiltonian(\n    labels,\n    coords,\n    charge=0,\n    mult=1,\n    basis='sto-3g',\n    method='pyscf',\n    active_electrons=4,\n    active_orbitals=4,\n)\n\nPlease make sure that you build the Hamiltonian correctly everywhere. You might also change the number of active_electrons and active_orbitals depending on the problem.2 Replies1", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/9"}, "9": {"author": "isaacdevlugt", "date": "1681825968304", "content": "Let us know if you still need help!", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/10"}, "10": {"author": "isaacdevlugt", "date": "1681309315470", "content": "The error here is stemming from this method 4. The number of alpha/beta electrons here means number of spin up/down electrons, and the error is saying that n_\\alpha + n_\\beta \\neq 63n\u03b1+n\u03b2\u226063.\nLooking at your code, I can indeed replicate the error you\u2019re getting. But, there are a few things that I\u2019m confused about:\n\n\nbenzene_hamiltonian isn\u2019t used beyond grabbing the number of qubits, but later on you define a different variable H with more electronic structure details . Not sure which one you want to use, but I assume it\u2019s H because that\u2019s what your VQE is optimizing against.\n\n\nsymbols isn\u2019t defined, but I assume you meant labels.\n\n\nIf I get rid of benzene_hamiltonian and move the electronic structure variable definitions above H (e.g., charge, multiplicity, etc.) so that it can be defined, I get a new error: ValueError: Openshell systems are not supported. Change the charge or spin multiplicity of the molecule. This means that there are unpaired electrons, which, as the error suggests, isn\u2019t supported. I tried several multiplicity values, assuming that you want charge to remain 0, and none of them worked.\n\n\nIn any case, I\u2019m going to get in touch with one of our qchem experts to see if they can help here . Hang tight!", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/11"}, "11": {"author": "sjahangiri", "date": "1682608522506", "content": "Hi @Dassen_Sathan. Could you please provide more details on how you computed these energies? What is the classical method you used? I also suggest computing the energy at the Hartree-Fock level to see how different it is from the VQE and classical results.", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/12"}, "12": {"author": "sjahangiri", "date": "1682620432332", "content": "Thanks @Dassen_Sathan. I am not sure if there is a guarantee that the classical force field energies should match the quantum VQE ones. You might compute the Hartree-Fock energy to have another  reference point. If you have any questions about the VQE computations, please feel free to let us know.", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/13"}, "13": {"author": "isaacdevlugt", "date": "1682963135127", "content": "Hey @Dassen_Sathan! It sounds like your application is unique and requires some work! If it helps, you can learn about integrating classical algorithms with quantum ones here:\n\nTurning quantum nodes into Keras Layers \u2014 PennyLane documentation\nTurning quantum nodes into Torch Layers \u2014 PennyLane documentation\n\nHope this helps!", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/14"}, "14": {"author": "isaacdevlugt", "date": "1683035712014", "content": "Thanks @Dassen_Sathan! You as well . Let us know if you have any more issues!", "link": "https://discuss.pennylane.ai//t/calculating-ground-energy-using-vqe-for-benzene/2792/15"}}