{"0": {"author": "jkwan314", "date": "1670977003895", "content": "I\u2019m trying to measure the purity of an input quantum state p (ie. Tr(p^2)). According to  this stack overflow post 3, we just prepare 2 copies of the input state and perform the swap operation on them, then measure the output. So this is the code I\u2019ve come up with:\n\n\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2022-12-13 \u5348\u5f8c4.15.122134\u00d7502 74.7 KB\n\nHowever, pennylane doesn\u2019t seem to support the SWAP operator as an observable. How should I do the measurement at the end of the circuit?\n\n\n Solved by CatalinaAlbornoz in post #4 \n\n\n                Hi @jkwan314 , \nYou can find the equation in Wikipedia. \nWe actually released version 0.28 of PennyLane yesterday and it includes a Purity transform . You can learn more about it in our release blog. \nThis transform creates a function that can be used to find the purity of your state. \nThis is how t\u2026\n              \n", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/1"}, "1": {"author": "CatalinaAlbornoz", "date": "1671581292202", "content": "Hi @jkwan314 ,\nI think you have a confusion between the state and the density matrix of the state. The purity is the trace of the density matrix squared. And you also have the following relationship where a is the vector representing the quantum state.\n\nMaybe something like the following code is what you\u2019re looking for.\nimport pennylane as qml\nfrom pennylane import numpy as np\n\ndev = qml.device('default.mixed',wires=2)\n\n@qml.qnode(dev)\ndef circuit():\n    qml.Hadamard(wires=0)\n    qml.CNOT(wires=[0, 1])\n    qml.BitFlip(0.2, wires=0)\n    return qml.state()\n\nstate = circuit()\nprint(\"State: \",state)\n\npurity = 0.5+0.5*np.linalg.norm(state)**2\n\nprint(f\"Purity = {purity:.4f}\")\n\nIf you comment the qml.BitFlip line you will notice that the purity becomes 1.\nIs this what you were looking for?", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/2"}, "2": {"author": "jkwan314", "date": "1671650091368", "content": "Hi @CatalinaAlbornoz ,\nThanks for your reply. I was just a bit confused about the implementation of the circuit. If a is the vector representing the quantum state, then why do we need to perform the CNOT and the BitFlip? Also, could I get a source for the equation you posted above?", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/3"}, "3": {"author": "CatalinaAlbornoz", "date": "1671665072765", "content": "Hi @jkwan314 ,\nYou can find the equation in Wikipedia 3.\nWe actually released version 0.28 of PennyLane yesterday and it includes a Purity transform 1 . You can learn more about it in our release blog.\nThis transform creates a function that can be used to find the purity of your state.\nThis is how the code would look:\n# Create a default.mixed device\ndev = qml.device(\"default.mixed\", wires=2)\n\n# Create a qnode\n@qml.qnode(dev)\ndef noisy_circuit(p):\n    # Add some gates\n    qml.Hadamard(wires=0)\n    qml.CNOT(wires=[0, 1])\n    # Add some noise (optional)\n    qml.BitFlip(p, wires=0)\n    # Return the state of the system\n    return qml.state()\n\n# Use the purity transform to calculate the purity for a specific value of the parameter p.\nqml.qinfo.transforms.purity(noisy_circuit, wires=[0, 1])(0.2) # In this case p=0.2\n\nLet me describe the code step by step:\n1 - You need to use the default.mixed device because you will be working with mixed states. If they were all pure then the purity would always be 1 and you wouldn\u2019t need to calculate it.\n2 - You create a qnode. All of your qubits start in the |0\u27e9 state so you need to add some gates to change the state.\n3 - If you want a pure state you don\u2019t add any noise. However if you add noise such as BitFlip then the purity will no longer be 1.\n4 - You need to return the state of the circuit. This means that you\u2019re not measuring, you\u2019re getting the state.\n5 - The purity transform takes your qnode and computes the purity of a sub-system from a given state. To find the purity of the overall state, we include all wires in the wires argument. Then we apply this transform to a specific value of the parameter(s), which in this case is 0.2.\nPlease let me know if this is clearer or if you have any further questions!Solution1", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/4"}, "4": {"author": "jkwan314", "date": "1672178398870", "content": "Hi @CatalinaAlbornoz , do you know if this purity function has been added to the latest version of pennylane on the xanadu quantum codebook? I can\u2019t seem to use it\u2026\n\n\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2022-12-28 \u5348\u524d6.58.352620\u00d7350 63.9 KB\n", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/5"}, "5": {"author": "CatalinaAlbornoz", "date": "1674143863295", "content": "Hi @jkwan314 ,\nI\u2019m not being able to replicate your error. The codebook is in fact using the latest version of PennyLane. You don\u2019t need to use the purity function though, but it shouldn\u2019t pop up this error. Do you still see this error? And if so, on what node? And using what code?1", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/6"}, "6": {"author": "jkwan314", "date": "1674192939999", "content": "Never mind, it works on my end now! Must have been updated sometime in between your response and my question.", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/7"}, "7": {"author": "CatalinaAlbornoz", "date": "1674664677478", "content": "I\u2019m glad it works now @jkwan314 !", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/8"}, "8": {"author": "jkwan314", "date": "1670977003895", "content": "I\u2019m trying to measure the purity of an input quantum state p (ie. Tr(p^2)). According to  this stack overflow post 3, we just prepare 2 copies of the input state and perform the swap operation on them, then measure the output. So this is the code I\u2019ve come up with:\n\n\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2022-12-13 \u5348\u5f8c4.15.122134\u00d7502 74.7 KB\n\nHowever, pennylane doesn\u2019t seem to support the SWAP operator as an observable. How should I do the measurement at the end of the circuit?\n\n\n Solved by CatalinaAlbornoz in post #4 \n\n\n                Hi @jkwan314 , \nYou can find the equation in Wikipedia. \nWe actually released version 0.28 of PennyLane yesterday and it includes a Purity transform . You can learn more about it in our release blog. \nThis transform creates a function that can be used to find the purity of your state. \nThis is how t\u2026\n              \n", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/9"}, "9": {"author": "jkwan314", "date": "1672178398870", "content": "Hi @CatalinaAlbornoz , do you know if this purity function has been added to the latest version of pennylane on the xanadu quantum codebook? I can\u2019t seem to use it\u2026\n\n\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2022-12-28 \u5348\u524d6.58.352620\u00d7350 63.9 KB\n", "link": "https://discuss.pennylane.ai//t/measuring-purity-of-a-quantum-state/2380/10"}}