{"0": {"author": "huhnja", "date": "1677235690853", "content": "Hello people,\nI want to use the jax interface to speed up my code with jax.jit and jax.vmap. However I am not even able to make a circuit instance with the jax interface. Following the jax tutorial here 2\nfrom jax.config import config\nconfig.update(\"jax_enable_x64\", True)\n\nimport jax\nimport jax.numpy as jnp\nimport pennylane as qml\n\n@qml.qnode(dev, interface=\"jax\")\ndef circuit(param):\n    qml.RX(param, wires=0)\n    qml.CNOT(wires=[0, 1])\n    return qml.expval(qml.PauliZ(0))\n\nI get the error message:\n\nTypeError: Can\u2019t instantiate abstract class DefaultQubitJax with abstract methods _abs, _conj, _dot\n\nI have Installed jax, jaxlib and pennylane and also made sure that they are on the newest version.\nAny help would be greatly appriciated.\nBest regards!\n\n\n Solved by Romain_Moyard in post #4 \n\n\n                Hi @huhnja ! There is an issue with Jax 0.4.4, you should downgrade to 0.4.3. The issue will be solved with 0.4.5. \nLet me know if there is anything else.\n              \n", "link": "https://discuss.pennylane.ai//t/defaultqubitjax-class-cannot-be-build/2631/1"}, "1": {"author": "CatalinaAlbornoz", "date": "1677289964337", "content": "Hi @huhnja, welcome to the forum!\nI think you forgot to create your device.\nYou can use something like:\ndev = qml.device(\"default.qubit.jax\", wires=2)\nThis should make your code run smoothly \nLet me know if this fixes your issue!", "link": "https://discuss.pennylane.ai//t/defaultqubitjax-class-cannot-be-build/2631/2"}, "2": {"author": "huhnja", "date": "1677500678311", "content": "Hi @CatalinaAlbornoz,\nthank you for your quick reply. I tried your sugesstion, but I get the same error. I am running this code on a cloud backend with a jupyter notebook as frontend. Could this explain the error I am getting?", "link": "https://discuss.pennylane.ai//t/defaultqubitjax-class-cannot-be-build/2631/3"}, "3": {"author": "Romain_Moyard", "date": "1677512977187", "content": "Hi @huhnja ! There is an issue with Jax 0.4.4, you should downgrade to 0.4.3. The issue will be solved with 0.4.5.\nLet me know if there is anything else.Solution", "link": "https://discuss.pennylane.ai//t/defaultqubitjax-class-cannot-be-build/2631/4"}, "4": {"author": "huhnja", "date": "1677592041145", "content": "Thank you @Romain_Moyard,\nThis solves the problem! And for other people reading this, you also need to downgrade jaxlib to version 0.4.3 1", "link": "https://discuss.pennylane.ai//t/defaultqubitjax-class-cannot-be-build/2631/5"}, "5": {"author": "huhnja", "date": "1677235690853", "content": "Hello people,\nI want to use the jax interface to speed up my code with jax.jit and jax.vmap. However I am not even able to make a circuit instance with the jax interface. Following the jax tutorial here 2\nfrom jax.config import config\nconfig.update(\"jax_enable_x64\", True)\n\nimport jax\nimport jax.numpy as jnp\nimport pennylane as qml\n\n@qml.qnode(dev, interface=\"jax\")\ndef circuit(param):\n    qml.RX(param, wires=0)\n    qml.CNOT(wires=[0, 1])\n    return qml.expval(qml.PauliZ(0))\n\nI get the error message:\n\nTypeError: Can\u2019t instantiate abstract class DefaultQubitJax with abstract methods _abs, _conj, _dot\n\nI have Installed jax, jaxlib and pennylane and also made sure that they are on the newest version.\nAny help would be greatly appriciated.\nBest regards!\n\n\n Solved by Romain_Moyard in post #4 \n\n\n                Hi @huhnja ! There is an issue with Jax 0.4.4, you should downgrade to 0.4.3. The issue will be solved with 0.4.5. \nLet me know if there is anything else.\n              \n", "link": "https://discuss.pennylane.ai//t/defaultqubitjax-class-cannot-be-build/2631/6"}}