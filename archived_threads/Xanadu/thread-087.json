{"0": {"author": "akb", "date": "1632004584055", "content": "symbols, coordinates = (['O','N','C','H','H','H','C'], \n                    np.array([1.1280, 0.2091, 0.0000, \n                              -1.1878, 0.1791, 0.0000, \n                              0.0598, -0.3882, 0.0000, \n                              -1.3085, 1.1864, 0.0001, \n                              -2.0305, -0.3861, -0.0001, \n                              -0.0014, -1.4883, -0.0001, \n                              -0.1805, 1.3955, 0.0000]))\nh, qubits = qchem.molecular_hamiltonian(\n    symbols,\n    coordinates,\n    name=\"hiv\",\n    charge=0,\n    mult=1,\n    basis='sto-3g',\n    active_electrons=2,\n    active_orbitals=2\n    )\nprint(h,qubits)\n\nelectrons = 2\nS2 = qchem.spin2(electrons, qubits)\nprint(S2)\n\nI have the above molecule with 7 atoms (1O, 1N, 3H, 2C). I am attempting to find its ground state energy by implementing the code provided as one of Amazon Braket\u2019s examples for Pennylane (https://github.com/aws/amazon-braket-examples/blob/main/examples/pennylane/3_Quantum_chemistry_with_VQE.ipynb 4).\nIs there a right way to calculate the number of active_electrons, active_orbitals, and electrons? If yes, in case of the molecule I am using, what values should I use in order to get the ground state energy that is closer to the experimental value?", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/1"}, "1": {"author": "Alain_Delgado_Gran", "date": "1632164563040", "content": "Hi @akb,\nThank you very much for sharing your question and welcome to the Xanadu forum!\n\nIs there a right way to calculate the number of active_electrons, active_orbitals, and electrons?\n\nNot really. Let me start by clarifying that defining an active space 10 is an approximation to keep the simulation within the computational resources at hand. In principle, one has to include all the electrons in the molecule. On the other hand, the total number of molecular orbitals M determines the number of qubits N_\\mathrm{qubits} = 2 \\times M (see this tutorial 12 for more details) .\nFor the \u201chiv\u201d molecule you have:\n\n\nTotal number of electrons N_e=30\n\n\nFor a minimal basis set (e.g., \u201csto-3g\u201d) M=23\n\n\nThis requires 46 qubits to simulate the molecular Hamiltonian. This is hard due to the size and depth of the variational circuit, and the number of terms in the decomposed Hamiltonian.\n\n\n\nA natural approximation is to neglect the core orbitals (orbitals with deep energies that are typically not important for chemical bonding). In your case there are 4 core orbitals populated by 8 core electrons. So you would end up with a system of 22 electrons and 19 valence orbitals which still requires significant resources (38 qubits). In order to reduce further the size of your simulation you can decrease the number of active electrons and orbitals. Currently, PennyLane simulators should be able to handle up to ~ 16 qubits. This corresponds to a symmetric active space with active_electrons = 8 and active_orbitals = 8. Note that if you have a chemical intuition about which orbitals you want to include in the active space you can use the decompose 7 function (see here 7) that allows you to choose the active orbitals.\n\nwhat values should I use in order to get the ground state energy that is closer to the experimental value?\n\nIncreasing the active space is crucial to improve the accuracy of the ground-state energy. Having said that, I would like to stress that a minimal basis set provides a poor representation of the molecular orbitals. Note that you can improve your basis set while keeping the size of your active space fixed.\nYou can also optimize your simulation by defining a quantum circuit that prepares a molecular state as close as possible to the true ground state of the system. For example, the most important contributions to the ground-state correlation energy can be captured by applying DoubleExcitation 1 operations to the M-qubit system initialized to encode the Hartree-Fock state of the molecule. I encourage you to take a look at the tutorial Adaptive circuits for quantum chemistry 2 showing how you can reduce the number of quantum gates in your circuit and improve the performance of your simulation.\nHope this helps.\nDo not hesitate to get back to us if you have further questions.\nThank you!\nPS: Please, make sure that the coordinates you are using to build the molecular Hamiltonian are in atomic units (Bohr radii). Based on the interatomic distances, they seem to be in Angstroms.3", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/2"}, "2": {"author": "pratjz", "date": "1632317911029", "content": "Thank You Alain for the detailed explanation,\nalso please advise where can one read/learn in more detail about how it works the atoms, orbitals, i.e more in depth intricate details\u2026", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/3"}, "3": {"author": "Alain_Delgado_Gran", "date": "1632326326563", "content": "Hi @pratjz,\nFor these topics there are many books/papers. I would recommend the book by Prof. Frank Jensen \u201cIntroduction to Computational Chemistry 7\u201d.\nIf you have questions, feel free to get back to us.\nBest regards,\nAlain.1", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/4"}, "4": {"author": "pratjz", "date": "1632371982098", "content": "Thank You Alain for the suggestion", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/5"}, "5": {"author": "pratjz", "date": "1633427443947", "content": "HI @Alain_Delgado_Gran\nOne more Question , is there a way I can find the ground state energy classically in pennylane ? for comparison b/w quantum & classical\nThanks\nPrateek", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/6"}, "6": {"author": "CatalinaAlbornoz", "date": "1633483852491", "content": "Hi @pratjz, you can use sparse_hamiltonian to build a sparse matrix which represents the hamiltonian, and then the smaller eigenvalue will be the ground state energy.\nThis is an example of how you could do it:\nimport pennylane as qml\nfrom pennylane import numpy as np\nfrom pennylane import qchem\n\nsymbols = [\"Li\", \"H\"]\ngeometry = np.array([0.0, 0.0, 0.0, 0.0, 0.0, 2.969280527])\n\nH, qubits = qchem.molecular_hamiltonian(\n    symbols,\n    geometry,\n    active_electrons=2,\n    active_orbitals=5\n)\n\nH_sparse = qml.utils.sparse_hamiltonian(H)\neigenvalues, eigenvectors = np.linalg.eig(sparse_matrix)\nground_state_energy=min(np.real(eigenvalues))\nprint('ground_state_energy: ',ground_state_energy)\n\nLet me know if this helps!2 Replies2", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/7"}, "7": {"author": "pratjz", "date": "1633492918784", "content": "Thank You very much @CatalinaAlbornoz this looks like what I was looking for \u2026will give it a try1", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/8"}, "8": {"author": "pratjz", "date": "1634542384229", "content": "\n\n\n CatalinaAlbornoz:\n\nsymbols = [\u201cLi\u201d, \u201cH\u201d] geometry = np.array([0.0, 0.0, 0.0, 0.0, 0.0, 2.969280527]) H, qubits = qchem.molecular_hamiltonian( symbols, geometry, active_electrons=2, active_orbitals=5 ) H_sparse = qml.utils.sparse_hamiltonian(H) eigenvalues, eigenvectors = np.linalg.eig(sparse_matrix) ground_state_energy=min(np.real(eigenvalues)) print('ground_state_energy: ',ground_state_energy)\n\n\nHI @CatalinaAlbornoz I was trying the suggested approach but it always gives the following error , Please help what am I missing\nLinAlgError: 0-dimensional array given. Array must be at least two-dimensional", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/9"}, "9": {"author": "pratjz", "date": "1634543578148", "content": "Please Ignore found the solution , Need to explicitly convert the sparse_matrix to an array like\neigenvalues, eigenvectors = np.linalg.eig(sparse_matrix.toarray())\nThank You ", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/10"}, "10": {"author": "CatalinaAlbornoz", "date": "1634566161677", "content": "I\u2019m glad you found a solution @pratjz!", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/11"}, "11": {"author": "Alain_Delgado_Gran", "date": "1632164563040", "content": "Hi @akb,\nThank you very much for sharing your question and welcome to the Xanadu forum!\n\nIs there a right way to calculate the number of active_electrons, active_orbitals, and electrons?\n\nNot really. Let me start by clarifying that defining an active space 10 is an approximation to keep the simulation within the computational resources at hand. In principle, one has to include all the electrons in the molecule. On the other hand, the total number of molecular orbitals MM determines the number of qubits N_\\mathrm{qubits} = 2 \\times MNqubits=2\u00d7M (see this tutorial 12 for more details) .\nFor the \u201chiv\u201d molecule you have:\n\n\nTotal number of electrons N_e=30Ne=30\n\n\nFor a minimal basis set (e.g., \u201csto-3g\u201d) M=23M=23\n\n\nThis requires 46 qubits to simulate the molecular Hamiltonian. This is hard due to the size and depth of the variational circuit, and the number of terms in the decomposed Hamiltonian.\n\n\n\nA natural approximation is to neglect the core orbitals (orbitals with deep energies that are typically not important for chemical bonding). In your case there are 4 core orbitals populated by 8 core electrons. So you would end up with a system of 22 electrons and 19 valence orbitals which still requires significant resources (38 qubits). In order to reduce further the size of your simulation you can decrease the number of active electrons and orbitals. Currently, PennyLane simulators should be able to handle up to ~ 16 qubits. This corresponds to a symmetric active space with active_electrons = 8 and active_orbitals = 8. Note that if you have a chemical intuition about which orbitals you want to include in the active space you can use the decompose 7 function (see here 7) that allows you to choose the active orbitals.\n\nwhat values should I use in order to get the ground state energy that is closer to the experimental value?\n\nIncreasing the active space is crucial to improve the accuracy of the ground-state energy. Having said that, I would like to stress that a minimal basis set provides a poor representation of the molecular orbitals. Note that you can improve your basis set while keeping the size of your active space fixed.\nYou can also optimize your simulation by defining a quantum circuit that prepares a molecular state as close as possible to the true ground state of the system. For example, the most important contributions to the ground-state correlation energy can be captured by applying DoubleExcitation 1 operations to the M-qubit system initialized to encode the Hartree-Fock state of the molecule. I encourage you to take a look at the tutorial Adaptive circuits for quantum chemistry 2 showing how you can reduce the number of quantum gates in your circuit and improve the performance of your simulation.\nHope this helps.\nDo not hesitate to get back to us if you have further questions.\nThank you!\nPS: Please, make sure that the coordinates you are using to build the molecular Hamiltonian are in atomic units (Bohr radii). Based on the interatomic distances, they seem to be in Angstroms.3", "link": "https://discuss.pennylane.ai//t/calculating-number-of-active-electrons-and-active-orbitals-for-a-given-molecule/1363/12"}}