{"0": {"author": "ryanhill1", "date": "1618850600127", "content": "Hey there, I\u2019m trying to make my first contribution to the PennyLane source code following the Development Guide. To setup my environment I ran the following:\ngit clone https://github.com/PennyLaneAI/pennylane\ncd pennylane\npip install -e .\npip install -r requirements.txt\npip install flaky\npip install pytest pytest-cov pytest-mock\n\nTo ensure everything was working correctly, I ran\nmake test\n\nwhich resulted in\ntests/circuit_graph/test_qasm.py ....................Fatal Python error: Aborted\n\nIs this a problem with that PennyLane module or with my installation?\n\n\n Solved by ryanhill1 in post #5 \n\n\n                Hi @josh , thanks for your response! \nI tried your two suggestions with Qiskit and for some reason that still didn\u2019t fix it; I ended up with the same error message. However, \u201cskipping\u201d that test class using the -k flag did work! \nSince I\u2019m only adding code to pennylane/devices/default_qubit.py, the \u2026\n              \n", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/1"}, "1": {"author": "glassnotes", "date": "1618867887907", "content": "Hi @ryanhill1,\n\nHey there, I\u2019m trying to make my first contribution to the PennyLane source code\n\nAwesome, look forward to seeing it! \n\nIs this a problem with that PennyLane module or with my installation?\n\nI\u2019ve been able to run the tests in a fresh environment with the same sequence of steps (in Python 3.7), so it\u2019d be good to get some additional information.\n\nWhat OS are you using?\nWhat version of Python are you using?\nIn what directory are you running make test?\n\nCould you also please paste any additional error messages or warnings that appear near the test_qasm.py output when it fails? Does it indicate a specific test that causes it to fail?\nThanks!", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/2"}, "2": {"author": "ryanhill1", "date": "1618872219099", "content": "Thanks for your quick response! I am using,\nmacOS Big Sur Version 11.2.3\nPython 3.8.5\nI am running make test in\n/Users/ryanhill/Desktop/pennylane\ni.e. directly after I cd pennylane. And here is the full output / error message:\n(qml) ryanhill@ryans-mbp pennylane % make test\npython3 -m pytest tests --tb=native --no-flaky-report\n====================================== test session starts =======================================\nplatform darwin -- Python 3.8.5, pytest-6.2.3, py-1.10.0, pluggy-0.13.1\nrootdir: /Users/ryanhill/Desktop/pennylane\nplugins: flaky-3.7.0, cov-2.11.1, mock-3.5.1\ncollected 7537 items / 5 skipped / 7532 selected                                                 \n\ntests/test_about.py ..                                                                     [  0%]\ntests/test_classical_gradients.py ...................                                      [  0%]\ntests/test_configuration.py .........                                                      [  0%]\ntests/test_device.py .........................................ss..........                 [  1%]\ntests/test_finite_diff.py ...................                                              [  1%]\ntests/test_hermitian_edge_cases.py ....................................................... [  2%]\n.............................                                                              [  2%]\ntests/test_init.py ....................................................................... [  3%]\n............s.s.............s.s.........s.s.............s.s............s..s............s.s [  4%]\n.............s.s.........s.s.............s.s............s..s............s.s.............s. [  5%]\ns.........s.s.............s.s............s..s............................................. [  6%]\n............................................s.s.............s.s.........s.s.............s. [  8%]\ns............s..s............s.s.............s.s.........s.s.............s.s............s. [  9%]\n.s............s.s.............s.s.........s.s.............s.s............s..s............. [ 10%]\n............................................................................s.s........... [ 11%]\n..s.s.........s.s.............s.s............s..s............s.s.............s.s.........s [ 12%]\n.s.............s.s............s..s............s.s.............s.s.........s.s............. [ 14%]\ns.s............s..s....................................................................... [ 15%]\n..............                                                                             [ 15%]\ntests/test_io.py .......                                                                   [ 15%]\ntests/test_measure.py .................................................................... [ 16%]\n............................................................                               [ 17%]\ntests/test_measurement_transformations.py ......................                           [ 17%]\ntests/test_numpy_wrapper.py ...............................................                [ 18%]\ntests/test_observable.py .                                                                 [ 18%]\ntests/test_operation.py .................................................................. [ 19%]\n......s......s............................................................................ [ 20%]\n...............................................                                            [ 20%]\ntests/test_optimize.py ................................................................... [ 21%]\n.......................................................................................... [ 23%]\n.................................................................................          [ 24%]\ntests/test_optimize_qng.py .....                                                           [ 24%]\ntests/test_optimize_shot_adapative.py ..................                                   [ 24%]\ntests/test_prob.py ......                                                                  [ 24%]\ntests/test_qaoa.py ..........................................                              [ 25%]\ntests/test_quantum_gradients.py .......................................................... [ 25%]\n.............................................................................              [ 26%]\ntests/test_qubit_device.py ............................................................... [ 27%]\n..................                                                                         [ 27%]\ntests/test_qubit_device_adjoint_jacobian.py .............................................. [ 28%]\n............................................................................               [ 29%]\ntests/test_queuing.py .........................                                            [ 29%]\ntests/test_tensor_measurements.py ........................................................ [ 30%]\n....................................................................................       [ 31%]\ntests/test_utils.py ...................................................................... [ 32%]\n............................................................                               [ 33%]\ntests/test_vqe.py ........................................................................ [ 34%]\n.......................................................................................... [ 35%]\n.......................................................................................... [ 36%]\n...........................................s.....s.....s...                                [ 37%]\ntests/test_wires.py .....................................................                  [ 38%]\ntests/beta/test_default_tensor.py ........................................................ [ 39%]\n.......................................................................................... [ 40%]\n......................s................................................................... [ 41%]\n.......................................................................................... [ 42%]\n...............................................................                            [ 43%]\ntests/beta/test_default_tensor_tf.py .........................................s.s......... [ 44%]\n.....................................................................................      [ 45%]\ntests/circuit_drawer/test_circuit_drawer.py ..........................                     [ 45%]\ntests/circuit_drawer/test_grid.py .........................................                [ 46%]\ntests/circuit_drawer/test_representation_resolver.py ..................................... [ 46%]\n.......................................................................................... [ 47%]\n.......................................................................................... [ 49%]\n.........................................................................                  [ 50%]\ntests/circuit_graph/test_circuit_graph.py .........                                        [ 50%]\ntests/circuit_graph/test_circuit_graph_hash.py ........................................... [ 50%]\n.................................................                                          [ 51%]\ntests/circuit_graph/test_qasm.py ....................Fatal Python error: Aborted\n\nThread 0x000070000f4a5000 (most recent call first):\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/concurrent/futures/thread.py\", line 78 in _worker\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 870 in run\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 932 in _bootstrap_inner\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 890 in _bootstrap\n\nThread 0x000070000e4a2000 (most recent call first):\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/concurrent/futures/thread.py\", line 78 in _worker\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 870 in run\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 932 in _bootstrap_inner\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 890 in _bootstrap\n\nThread 0x000070000d49f000 (most recent call first):\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/concurrent/futures/thread.py\", line 78 in _worker\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 870 in run\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 932 in _bootstrap_inner\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 890 in _bootstrap\n\nThread 0x000070000c49c000 (most recent call first):\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/concurrent/futures/thread.py\", line 78 in _worker\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 870 in run\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 932 in _bootstrap_inner\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/threading.py\", line 890 in _bootstrap\n\nThread 0x000070000b499000 (most recent call first):\n<no Python frame>\n\nCurrent thread 0x0000000104a57e00 (most recent call first):\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/qiskit/providers/aer/backends/backend_utils.py\", line 51 in cpp_execute\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/qiskit/providers/aer/backends/backend_utils.py\", line 65 in available_methods\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/qiskit/providers/aer/backends/qasm_simulator.py\", line 284 in __init__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/qiskit/providers/aer/aerprovider.py\", line 33 in __init__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/qiskit/providers/aer/__init__.py\", line 74 in <module>\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\n  File \"<frozen importlib._bootstrap_external>\", line 783 in exec_module\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/qiskit/__init__.py\", line 57 in <module>\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\n  File \"<frozen importlib._bootstrap_external>\", line 783 in exec_module\n  File \"<frozen importlib._bootstrap>\", line 671 in _load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 975 in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 991 in _find_and_load\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/outcomes.py\", line 208 in importorskip\n  File \"/Users/ryanhill/Desktop/pennylane/tests/circuit_graph/test_qasm.py\", line 679 in check_dependencies\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 932 in call_fixture_func\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 1126 in pytest_fixture_setup\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/callers.py\", line 187 in _multicall\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 84 in <lambda>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 93 in _hookexec\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/hooks.py\", line 286 in __call__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 1072 in execute\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 687 in _compute_fixture_value\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 601 in _get_active_fixturedef\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 581 in getfixturevalue\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/fixtures.py\", line 568 in _fillfixtures\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/python.py\", line 1647 in setup\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 449 in prepare\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 150 in pytest_runtest_setup\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/callers.py\", line 187 in _multicall\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 84 in <lambda>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 93 in _hookexec\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/hooks.py\", line 286 in __call__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 255 in <lambda>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 311 in from_call\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 254 in call_runtest_hook\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/flaky/flaky_pytest_plugin.py\", line 138 in call_and_report\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 120 in runtestprotocol\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/runner.py\", line 109 in pytest_runtest_protocol\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/flaky/flaky_pytest_plugin.py\", line 94 in pytest_runtest_protocol\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/callers.py\", line 187 in _multicall\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 84 in <lambda>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 93 in _hookexec\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/hooks.py\", line 286 in __call__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/main.py\", line 348 in pytest_runtestloop\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/callers.py\", line 187 in _multicall\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 84 in <lambda>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 93 in _hookexec\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/hooks.py\", line 286 in __call__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/main.py\", line 323 in _main\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/main.py\", line 269 in wrap_session\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/main.py\", line 316 in pytest_cmdline_main\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/callers.py\", line 187 in _multicall\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 84 in <lambda>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/manager.py\", line 93 in _hookexec\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pluggy/hooks.py\", line 286 in __call__\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/config/__init__.py\", line 162 in main\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/_pytest/config/__init__.py\", line 185 in console_main\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/site-packages/pytest/__main__.py\", line 5 in <module>\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/runpy.py\", line 87 in _run_code\n  File \"/Users/ryanhill/opt/anaconda3/envs/qml/lib/python3.8/runpy.py\", line 194 in _run_module_as_main\nmake: *** [test] Abort trap: 6\n", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/3"}, "3": {"author": "josh", "date": "1618892301130", "content": "Hey @ryanhill1!\nIn the file tests/circuit_graph/test_qasm.py, we have a test class that tests integration between our QASM conversion and Qiskit:\nclass TestQASMConformanceTests:\n    \"\"\"Conformance tests to ensure that the CircuitGraph\n    serialized QASM conforms to the QASM standard as implemented\n    by Qiskit. Note that this test class requires Qiskit and\n    PennyLane-Qiskit as a dependency.\"\"\"\n\nBased on the traceback, it seems to me that this is the test that is failing  This test is automatically skipped if Qiskit is not found, but run if it is.\nTwo potential thoughts on solving this:\n\nCould you try upgrading to the latest Qiskit version (if not yet upgraded?)\nCould you try installing the latest GitHub master version of the Qiskit plugin (pip install git+https://github.com/PennyLaneAI/pennylane-qiskit.git)?\n\nIf this doesn\u2019t work, what might work is to \u2018skip\u2019 this particular test class from running:\npython -m pytest tests --tb=native --no-flaky-report -k \"not TestQASMConformanceTests\"\n\n(the -k flag is great, and allows you to pass a boolean string to choose exactly the tests that you want to run  )", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/4"}, "4": {"author": "ryanhill1", "date": "1618932790564", "content": "Hi @josh , thanks for your response!\nI tried your two suggestions with Qiskit and for some reason that still didn\u2019t fix it; I ended up with the same error message. However, \u201cskipping\u201d that test class using the -k flag did work!\nSince I\u2019m only adding code to pennylane/devices/default_qubit.py, the only test class I really care about is pennylane/tests/devices/test_default_qubit.py. Is there a way I can use a flag to run only that test? Sorry if that\u2019s a dumb question, my background is in physics so I\u2019m new to software development and still learning commands.Solution", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/5"}, "5": {"author": "josh", "date": "1618932988224", "content": "\nIs there a way I can use a flag to run only that test?\n\nDefinitely! If you want to only run a single test file, simply pass the filepath to the file when calling pytest:\npython -m pytest tests/devices/test_default_qubit.py --tb=native --no-flaky-report\n\nYou can also use this in addition to the -k flag if you only want to run certain test functions or classes from within this file.1", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/6"}, "6": {"author": "ryanhill1", "date": "1618958780602", "content": "Resolved the issue! Sorry to bother you.", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/7"}, "7": {"author": "josh", "date": "1618983039029", "content": "Glad you got it working @ryanhill1  Let us know if you have any other questions!", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/8"}, "8": {"author": "ryanhill1", "date": "1618850600127", "content": "Hey there, I\u2019m trying to make my first contribution to the PennyLane source code following the Development Guide. To setup my environment I ran the following:\ngit clone https://github.com/PennyLaneAI/pennylane\ncd pennylane\npip install -e .\npip install -r requirements.txt\npip install flaky\npip install pytest pytest-cov pytest-mock\n\nTo ensure everything was working correctly, I ran\nmake test\n\nwhich resulted in\ntests/circuit_graph/test_qasm.py ....................Fatal Python error: Aborted\n\nIs this a problem with that PennyLane module or with my installation?\n\n\n Solved by ryanhill1 in post #5 \n\n\n                Hi @josh , thanks for your response! \nI tried your two suggestions with Qiskit and for some reason that still didn\u2019t fix it; I ended up with the same error message. However, \u201cskipping\u201d that test class using the -k flag did work! \nSince I\u2019m only adding code to pennylane/devices/default_qubit.py, the \u2026\n              \n", "link": "https://discuss.pennylane.ai//t/make-test-fatal-python-error/985/9"}}