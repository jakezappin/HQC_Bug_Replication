{"0": {"author": "sassan_moradi", "date": "1615883012101", "content": "i want to design a swap classifier using amplitude encoding method Pennylane. But i got this error:\npennylane._device.DeviceError: Operation QubitStateVector cannot be used after other Operations have already been applied on a default.qubit.autograd device.\n\nTom explained to me before about the source of issue About amplitude embedding 15. Here is my code:\n@qml.qnode(dev)\ndef swap_test(x1, x2):\n\n    # load the two inputs into two different registers\n    qml.templates.embeddings.AmplitudeEmbedding(x1, wires=[1, 2, 3, 4, 5])\n    qml.templates.embeddings.AmplitudeEmbedding(x2, wires=[6, 7, 8, 9, 10])\n   \n    qml.Hadamard(wires=0)\n    \n    qml.CSWAP(wires=[0, 1, 6])\n    qml.CSWAP(wires=[0, 2, 7])\n    qml.CSWAP(wires=[0, 3, 8])\n    qml.CSWAP(wires=[0, 4, 9])\n    qml.CSWAP(wires=[0, 5, 10])\n\n    qml.Hadamard(wires=0)\n\n    return qml.expval(qml.PauliZ(0))\n\nas you can see the second qml.templates.embeddings.AmplitudeEmbedding(x2, wires=[6, 7, 8, 9, 10]) is at the first of circuit. It should work without error. But it did\u2019t. Do you know how i can solve this problem.", "link": "https://discuss.pennylane.ai//t/design-a-swap-test-classifier-with-amplitude-embedding/918/1"}, "1": {"author": "josh", "date": "1615893145895", "content": "Hi @sassan_moradi! Hmm, this appears to be a bug in PennyLane \u2014 it is assuming that only the first operation can be a state preparation operation. Would you mind making a quick issue 27 on the PennyLane GitHub? Thanks!", "link": "https://discuss.pennylane.ai//t/design-a-swap-test-classifier-with-amplitude-embedding/918/2"}, "2": {"author": "sassan_moradi", "date": "1615894999437", "content": "Sure. i will do it now.1", "link": "https://discuss.pennylane.ai//t/design-a-swap-test-classifier-with-amplitude-embedding/918/3"}, "3": {"author": "josh", "date": "1616132751305", "content": "@sassan_moradi since the conversation continued on GitHub, I will close this topic for now \u2013 feel free to open up a new one for any additional questions!", "link": "https://discuss.pennylane.ai//t/design-a-swap-test-classifier-with-amplitude-embedding/918/4"}, "4": {"author": "sassan_moradi", "date": "1615883012101", "content": "i want to design a swap classifier using amplitude encoding method Pennylane. But i got this error:\npennylane._device.DeviceError: Operation QubitStateVector cannot be used after other Operations have already been applied on a default.qubit.autograd device.\n\nTom explained to me before about the source of issue About amplitude embedding 15. Here is my code:\n@qml.qnode(dev)\ndef swap_test(x1, x2):\n\n    # load the two inputs into two different registers\n    qml.templates.embeddings.AmplitudeEmbedding(x1, wires=[1, 2, 3, 4, 5])\n    qml.templates.embeddings.AmplitudeEmbedding(x2, wires=[6, 7, 8, 9, 10])\n   \n    qml.Hadamard(wires=0)\n    \n    qml.CSWAP(wires=[0, 1, 6])\n    qml.CSWAP(wires=[0, 2, 7])\n    qml.CSWAP(wires=[0, 3, 8])\n    qml.CSWAP(wires=[0, 4, 9])\n    qml.CSWAP(wires=[0, 5, 10])\n\n    qml.Hadamard(wires=0)\n\n    return qml.expval(qml.PauliZ(0))\n\nas you can see the second qml.templates.embeddings.AmplitudeEmbedding(x2, wires=[6, 7, 8, 9, 10]) is at the first of circuit. It should work without error. But it did\u2019t. Do you know how i can solve this problem.", "link": "https://discuss.pennylane.ai//t/design-a-swap-test-classifier-with-amplitude-embedding/918/5"}}