{"0": {"author": "shangshang_shi", "date": "1657184039434", "content": "hi, everyone,\nI want to know if Pennylane support the evolution of density matrix, that is, the input of the circuit is a density matrix but not a state vector.\n\n\n Solved by CatalinaAlbornoz in post #9 \n\n\n                Hi @shangshang_shi, \nYou can use a single optimizer for both circuits but you need to have a single cost function. One reason why you may be running into problems is because you haven\u2019t set your parameters as trainable. You can define your initial parameters \u2018params\u2019 outside of the \u2018train\u2019 function \u2026\n              \n", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/1"}, "1": {"author": "CatalinaAlbornoz", "date": "1657222602346", "content": "Hi @shangshang_shi,\nQubitDensityMatrix 3 allows you to prepare a density matrix on a subsystem. Is this what you were looking for? You can also use density_matrix as the measurement in your circuit.", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/2"}, "2": {"author": "shangshang_shi", "date": "1657429546172", "content": "please click the picture\nyou can see the full screeshot", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/3"}, "3": {"author": "CatalinaAlbornoz", "date": "1657579206260", "content": "Hi @shangshang_shi,\nThe @qml.qnode(dev) part is very important because it\u2019s the part that makes your circuit a quantum node (qnode). If you don\u2019t add it then PennyLane won\u2019t know what device to run this circuit on.\nFrom what I can see in your code the problem is that you\u2019re trying to put one quantum circuit into another. I would suggest that you try passing the density matrix as a parameter of the second circuit instead, and see if this fixes your problem.\nLet me know if this helps!1", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/4"}, "4": {"author": "CatalinaAlbornoz", "date": "1657670645762", "content": "Hi @shangshang_shi,\nYou can use a single optimizer for both circuits but you need to have a single cost function. One reason why you may be running into problems is because you haven\u2019t set your parameters as trainable. You can define your initial parameters \u2018params\u2019 outside of the \u2018train\u2019 function and set them as trainable by adding the \u201crequires_grad\u201d argument to the array like this: params = np.array([0.1,0.2,0.3,0.2],requires_grad=True) . This will let the optimizer know that you need to optimize over these parameters. You can do the same for any other parameters that you need to train.\nI also saw somewhere in your code that you have ._value. This will cause problems with the differentiation. I recommend that you try to simplify your program so that you can avoid this.\nPlease let me know if this helps!Solution", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/5"}, "5": {"author": "shangshang_shi", "date": "1657675491546", "content": "hi ,@CatalinaAlbornoz,\npennylane has the numpy library,  if we set params = np.array([0.1,0.2,0.3,0.2]), arguments will has the property, \u201crequires_grad=True\u201d.\nYou give the other suggestion, help me a lot. Here\u2019s where the problem arose.\nThank  you very much.\nYou are a great problems solver.", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/6"}, "6": {"author": "CatalinaAlbornoz", "date": "1657766955156", "content": "I\u2019m glad I could help you solve your problem @shangshang_shi! And thank you for the compliment ", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/7"}, "7": {"author": "shangshang_shi", "date": "1657184039434", "content": "hi, everyone,\nI want to know if Pennylane support the evolution of density matrix, that is, the input of the circuit is a density matrix but not a state vector.\n\n\n Solved by CatalinaAlbornoz in post #9 \n\n\n                Hi @shangshang_shi, \nYou can use a single optimizer for both circuits but you need to have a single cost function. One reason why you may be running into problems is because you haven\u2019t set your parameters as trainable. You can define your initial parameters \u2018params\u2019 outside of the \u2018train\u2019 function \u2026\n              \n", "link": "https://discuss.pennylane.ai//t/hi-everyone-does-the-pennylane-support-the-evolution-of-density-matrix-thanks/2024/8"}}