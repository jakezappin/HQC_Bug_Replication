{"0": {"author": "yypai", "date": "1622506239950", "content": "Hello I\u2019m trying to see destructive interference of from Mach Zehnder interferometer when the phase difference between the two arms is pi. Here\u2019s the script:\nimport strawberryfields as sf\nfrom strawberryfields.ops import *\n\nimport numpy as np\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\n# start here: \nprog = sf.Program(2)\neng = sf.Engine(\"gaussian\", backend_options={\"cutoff_dim\": 10})\n\nwith prog.context as q:\n    Coherent(2, 0)  | q[0]\n    Coherent(2, 0)  | q[1]\n    \n    MZgate(np.pi, 0) | (q[0], q[1])\n\n#eng.reset()\nstate = eng.run(prog).state\nresults = eng.run(prog)\n\nplt.figure(figsize = (10, 5))\nfor i in range(2):\n    plt.subplot(1, 2, i + 1)\n    X = np.linspace(-10, 10, 100)\n    P = np.linspace(-10, 10, 100)\n    Z = state.wigner(i, X, P)\n    X, P = np.meshgrid(X, P)\n    plt.pcolormesh(X, P, Z, cmap = 'RdBu_r')\n    plt.xlabel('X'); plt.ylabel('P')\n\nplt.tight_layout()\nplt.show()\n\n\nI don\u2019t think I see any interference as a function of the phi_in  of the MZgate.  I tried both gaussian and fock bases. Maybe my displacement operator is only 2 is causing problem since it might Hong-Ou-Mandel?\n\n\n Solved by Nicolas_Quesada in post #4 \n\n\n                Hi @yypai \u2014 What you are seeing by looking into the energy (mean photon number) at the output is indeed interference, but al the classical type. Classical Maxwell\u2019s equation are more than sufficient to explain what you are seeing.\n              \n", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/1"}, "1": {"author": "Nicolas_Quesada", "date": "1622550451837", "content": "Hi @yypai: I am not sure you will see anything as a function of phi_in since your interferometer is fixed to be MZgate(np.pi, 0)", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/2"}, "2": {"author": "yypai", "date": "1622553331304", "content": "Thank you Nicolas. Sorry, I mean I manually changed the np.pi to several different values. Please also allow me to add some details. I also changed the coherent states to Coherent(4, 0). Below are the Wigner functions of the q[0] and q[1] after MZI.\n\nbitmap960\u00d71920 78 KB\n\nI see the photon number (distance from origin) does not change when internal phase is 0 or pi, but photon number is doubled in one whereas the other becomes zero when the internal phase is pi/2 or 3*pi/2. I guess this is a manifestation of Hong-Ou-Mandel effect here? Thanks again!\nAlso, is it possible to see the classical limit, i.e., destructive interference when internal phase = pi. I guess I need large photon number to see that maybe? Thank you again!", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/3"}, "3": {"author": "Nicolas_Quesada", "date": "1622566685690", "content": "Hi @yypai \u2014 What you are seeing by looking into the energy (mean photon number) at the output is indeed interference, but al the classical type. Classical Maxwell\u2019s equation are more than sufficient to explain what you are seeing.Solution", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/4"}, "4": {"author": "yypai", "date": "1622580994286", "content": "Thank you again Nicolas.\nI think I see why I didn\u2019t understand earlier now. For semiclassical = coherent light source Wikipedia MZI 1 I see destructive interference when internal phase is pi.\nHere I see destructive interference when the internal phase is pi/2 and 3pi/2 because this parameter is not the same thing as I thought, it\u2019s the argument for this ops.Rgate 2.", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/5"}, "5": {"author": "Nicolas_Quesada", "date": "1622583860397", "content": "Correct! Glad it was helpful.", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/6"}, "6": {"author": "yypai", "date": "1622506239950", "content": "Hello I\u2019m trying to see destructive interference of from Mach Zehnder interferometer when the phase difference between the two arms is pi. Here\u2019s the script:\nimport strawberryfields as sf\nfrom strawberryfields.ops import *\n\nimport numpy as np\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\n# start here: \nprog = sf.Program(2)\neng = sf.Engine(\"gaussian\", backend_options={\"cutoff_dim\": 10})\n\nwith prog.context as q:\n    Coherent(2, 0)  | q[0]\n    Coherent(2, 0)  | q[1]\n    \n    MZgate(np.pi, 0) | (q[0], q[1])\n\n#eng.reset()\nstate = eng.run(prog).state\nresults = eng.run(prog)\n\nplt.figure(figsize = (10, 5))\nfor i in range(2):\n    plt.subplot(1, 2, i + 1)\n    X = np.linspace(-10, 10, 100)\n    P = np.linspace(-10, 10, 100)\n    Z = state.wigner(i, X, P)\n    X, P = np.meshgrid(X, P)\n    plt.pcolormesh(X, P, Z, cmap = 'RdBu_r')\n    plt.xlabel('X'); plt.ylabel('P')\n\nplt.tight_layout()\nplt.show()\n\n\nI don\u2019t think I see any interference as a function of the phi_in  of the MZgate.  I tried both gaussian and fock bases. Maybe my displacement operator is only 2 is causing problem since it might Hong-Ou-Mandel?\n\n\n Solved by Nicolas_Quesada in post #4 \n\n\n                Hi @yypai \u2014 What you are seeing by looking into the energy (mean photon number) at the output is indeed interference, but al the classical type. Classical Maxwell\u2019s equation are more than sufficient to explain what you are seeing.\n              \n", "link": "https://discuss.pennylane.ai//t/sf-ops-mzgate-no-observable-interference-as-a-function-of-phase/1077/7"}}